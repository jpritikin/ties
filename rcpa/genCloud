#!/usr/bin/perl

use strict;
use warnings;
use Archive::Zip qw(AZ_OK);
use Text::CSV_XS;
use Text::Unidecode;
use Fatal qw(open);
use Graph;
use Date::Manip;
use POSIX qw(strftime);
use Data::Dumper;
use IO::String;
use utf8 'all';

my %ShortDict =
  ('mountainbiking' => 'mountain biking',
   'powerlifting' => 'weightlifting',
   'lifting' => 'weightlifting',
   'lifting weights' => 'weightlifting',
   'weight lifting' => 'weightlifting',
   'resistance training' => 'weightlifting',
   'strength training' => 'weightlifting',
   'weight training' => 'weightlifting',
   weightlifting => 'weightlifting',
   'softball' => 'baseball',
   'biking' => 'cycling',
   'bicylcing' => 'cycling',
   'bicycling' => 'cycling',
   'bike riding' => 'cycling',
   'jogging' => 'running',
   'zumba' => 'aerobic exercise',
   'playing soccer' => 'soccer',
   'horseback riding' => 'horseback riding',
   'refereeing high school basketball' => 'invalid',  # too many variations TODO
   'karate' => 'karate',
   'boxing' => 'boxing',
   'squash' => 'squash',
   'racquetball' => 'racquetball', # really different from squash? TODO
   'yoga' => 'hatha yoga',
   'gymnastics' => 'invalid',  # not specific enough
   'lacrosse' => 'lacrosse',
   'gym' => 'invalid',        # probably weights or running, but which?
   'circuit training' => 'weightlifting',
   'dodgeball' => 'dodgeball',
   'rugby' => 'rugby',
   'quidditch' => 'quidditch (sport)',
   'gym, jogging' => 'invalid',
   'run' => 'running',
   'swim' => 'swimming',
   'training' => 'invalid',
   'rugby union' => 'rugby',
   'lawn tennis' => 'tennis',
   'cross-fit' => 'running',
   'jiijoiojjio' => 'invalid',
   'inline skate' => 'inline skating',
   'magic,singing' => 'invalid',
   stretching => 'stretching',
   'frisbee golf' => 'disc golf',
   curling => 'curling',
   'walked laps around the track' => 'walking',
   kabaddi => 'kabaddi in India',
   'relay' => 'invalid',
   elliptical => 'elliptical',
   'cross-trainer' => 'elliptical',
   crossfit => 'invalid',   # see https://en.wikipedia.org/wiki/CrossFit
   'push up' => 'calisthenics',
   'push ups' => 'calisthenics',
   'pop pilates' => 'pilates',
   'jet skiing' => 'personal water craft',  # TODO think of better name
   kickboxing => 'kickboxing'
  );

# what about stationary bicycle? same as elliptical? ugh
# split wrestling & jiu jitsu?
# combine canoeing and kayaking?

my %LongDict =
  (
   'basketball@indoor basketball' => 'basketball',
   'skiing@snow skiing' => 'snow skiing',
   'swimming@butterfly' => 'swimming',
   'weightlifting@i do a 6 day a week push-pull-leg routine (search up coolcicadas ppl for an idea of what i do), in the gym anytime from 45 minutes to an hour' => 'weightlifting',
   'lifting@weight lifting' => 'weightlifting',
   'weight lifting@repeat, weight lifting' => 'weightlifting',
   'hockey@ice hockey goalie' => 'ice hockey',
   'body balance@it is mixture of yoga and pilates, but more dynamic and the exercises  have "choreographies" that fit with specific songs' => 'pilates',
   'golf@college golf' => 'golf',
   'baseball@college baseball' => 'baseball',
   'belly dancing@middle eastern dance low impact' => 'dancing',  # dancing too large a category? TODO
   'bowling@10-pin style' => 'bowling',
   'baseball@college baseball' => 'baseball',
   'running@marathon and mini-marathon training' => 'running',
   'running@road running' => 'running',
   'running@running to get in shape' => 'running',
   'basketball@playing basketball 3 on 3' => 'basketball',
   'running@running on a track' => 'running',
   'golf@college golf' => 'golf',
   'baseball@college baseball' => 'baseball',
   'mma@mixed martial arts' => 'mixed martial arts',
   'martial arts@brazilian jiu jitsu' => 'wrestling',
   'martial arts@taekwondo - mostly kicking  brazilian jiu jitsu - ground based grappling/submission wrestling  mixed martial arts - mix of striking and grappling' => 'mixed martial arts',
   'football@american football' => 'football',
   'basketball@american basketball' => 'basketball',
   'walking@walking at a brisk pace through the neighborhood' => 'walking',
   'swimming@swimming at the beach and riding the waves' => 'swimming',
   'running@recreational running for the health and stress relief with the occasional race for fun' => 'running',
   'basketball@semi competitive club basketball on a college team' => 'basketball',
   'football@running and chasing after the running back' => 'football',
   'running@free running outside' => 'running',
   'swimming@distance swimming' => 'swimming',
   'running@running on treadmill' => 'running',
   'running@running on a treadmill to burn fat' => 'running',
   'mma@mixed martial arts'=> 'mixed martial arts',
   'football@intramural flag football' => 'football',
   'running@ran 1 mile' => 'running',
   'ultimate frisbee@7 vs 7 frisbee on an approximate 50 yard field in college 2-3x per week' => 'ultimate frisbee',
   'soccer@intramural indoor soccer' => 'soccer',
   'soccer@advanced soccer, collegial elective course' => 'soccer',
   'soccer@i play soccer with a group' => 'soccer',
   'soccer@i play soccer when i am not dancing' => 'soccer',
   'tennis@womens singles tennis' => 'tennis',
   'hiking@hiking in local park' => 'hiking',
   'tennis@singles' => 'tennis',
   'skiing@water skiing' => 'water skiing',
   'ping pong@also known as table tennis' => 'table tennis',
   'cricket@cricket- will answer questions in relation to bowling only' => 'cricket',
   'weight lifting@core and weight lifting to lean muscles' => 'weightlifting',
   'lifting@lifting weights' => 'weightlifting',
   'lifting@lifting weights to make my muscles stronger' => 'weightlifting',
   'tennis@singles tennis' => 'tennis',
   'cycling@bike riding for exercise, sport, and transportation' => 'cycling',
   'dance@hiphop dance' => 'dance',
   'dance@dance is what i rote and it is basically just hip hop dance!' => 'dance',
   'snowboarding@downhill snowboarding' => 'snowboarding',
   'vinyasa yoga@hot flow yoga' => 'hatha yoga',
   'hiit@high intensity interval training class at ymca (45-55 min)' => 'aerobic exercise',
   'track and field@shot-put and discus' => 'throwing sports',
   'netball@position- goal defence' => 'netball',
   'swimming@competitive lap swimming' => 'swimming',
   'running@running around a track' => 'running',
   'swimming@doing laps in a pool' => 'swimming',
   'running@running long distances of 1-2 miles or more' => 'running',
   'powerlifting@powerlifting is a sport that is based on your 1-rm  in a competition setting, the athlete (myself) will have 3 chances to execute each one of the big lifts  the big lifts are, squat, bench, and dead' => 'weightlifting',
   'softball@high school' => 'baseball',
   'softball@i practice hitting and fielding' => 'baseball',
   'basketball@i run, dribble, and shoot basketballs' => 'basketball',
   'softball@hit and through softballs, ran, and had several workouts' => 'baseball',
   'basketball@ran, dribbled, and shot the basketballs' => 'basketball',
   'basketball@womens college basketball' => 'basketball',
   'basketball@college womens basketball' => 'basketball',
   'softball@church league softball' => 'baseball',
   'slow-pitch softball@slow-pitch softball is a recreational co-ed sport that i participate in  generally you will have 4 out fielders and a regular infield set up, the pitcher will lob the ball for the batter to hit  the' => 'baseball',
   'swimming@swimming laps in a pool back and forth' => 'swimming',
   'surfboard surfing@riding medium size (10) waves on the n shore and california' => 'surfing',
   'stand up paddle surfing@riding medium size (10) waves on the n shore and california but with less effort and risk than on a surfboard as standing minimizes take off risk' => 'stand up paddle surfing',
   'volleyball@hitting a ball back and forth over a net avoiding it from touching the ground' => 'volleyball',
   'springboard diving@1-meter and 3-meter springboard diving' => 'diving',
   'weight lifting@dumbbells' => 'weightlifting',
   'lifting@lifting weights in a gym setting' => 'weightlifting',
   'weight lifting@i do a variation of hang cleans, barbell squats, dead lifts, over-head snatchs, and any type of olympic lifts in sets that range from 5x5, 4x10, 5x3' => 'weightlifting',
   'running@i run outside or on a treadmill usually 2 miles or i elliptical for 30-45 min at moderate intensity' => 'invalid',
   'tennis@tennis competitive, singles and doubles' => 'tennis',
   'basketball@social group with friends, not competitive' => 'basketball',
   'ice skating@2 hours session oft skating, together with some friends' => 'ice skating',
   'swimming@just swimming straight eines with a friend for 15 hours per week' => 'swimming',
   'biking@riding my e-bike beyond the city limits' => 'cycling',
   'basketball@pickup basketball at the park' => 'basketball',
   'swimming@competitive swimming' => 'swimming',
   'basketball@varsity womens basketball' => 'basketball',
   'walking@i take long walks' => 'walking',
   'running@long distance running' => 'running',
   'swimming@swimming for cardio' => 'swimming',
   'gymnastics@medical gymnastics' => 'weightlifting',
   'gym@legs, abs and arm exercises' => 'weightlifting',
   'gym@i go to the gim to gain muscle mass i train breast, legs, arms, neck and back' => 'weightlifting',
   'trail running@running mostly on single-trails in the forest, with much incline' => 'running',
   'martial arts@wah lum kung fu' => 'Chinese martial arts',
   'swimming@lap swimming (freestyle), twice a week for roughly an hour each session' => 'swimming',
   'ballet@i take beginner adult ballet classes, once a week' => 'ballet',
   'swimming@taking my kids to the swimming pool, diving, racing with them, playing basketball in the water, pulling and pushing them on floatation devices' => 'swimming',
   'walking@daily half hour walks outdoors in my town' => 'walking',
   'football@flag football, outdoors' => 'flag football',
   'marathon@walking a marathon, because of a drunken bet' => 'walking',
   'running@indoor running' => 'running',
   'volleyball@indoor volleyball' => 'volleyball',
   'zumba class@group exercise class' => 'aerobic exercise',
   'swimming@lap swimming, all four strokes plus drills and flip turns  - both for exercise and competition' => 'swimming',
   'hiking@walking around, especially on natural trails' => 'hiking',
   'free weights@lifting weights not attached to a machine' => 'weightlifting',
   'skiing@resort skiing on trails, glades, and bowls in new england, va, and co' => 'snow skiing',  # split from downhill? TODO
   'grappling@brazilian jiu jitsu and judo although these are martial arts, they are more similar to to wrestling than boxing, karate, or tae kwon do' => 'mixed martial arts',
   'swimming walking@i would walk in the gym and for swimming i would just hang out with my friend in the' => 'invalid',
   'yuga@i would do stretch s' => 'hatha yoga',
   'strongman competition@strongman competitions include tests of strength and power including deadlift, clean and press, carrying, loading, pulling, and flipping in contrast to powerlifting (squat, deadlift, bench press) or' => 'invalid',
   'soccer@organized outdoor 11 v 11 soccer' => 'soccer',
   'basketball@pick-up basketball' => 'basketball',
   'mountain biking@cross country mountain biking on mixed use and dedicated trails in the eastern coast states  trail ratings of mainly blue and black' => 'mountain biking',
   'treadmill@walking on a treadmill, at 37 speed, using rolling hills setting' => 'walking',
   'running@running on the elliptical machine' => 'elliptical',
   'elliptical@using an elliptical machine' => 'elliptical',
   'weightlifting@weightlifting using gym machine equipment (not free weights)' => 'weightlifting',
   'running@jogging and running daily' => 'running',
   'cardio fitness@cardio training with online videos at home' => 'aerobic exercise',
   'swimming@breaststroke' => 'swimming',
   'walking@walking up and down the hills' => 'walking',
   'cycling@cycling tours 50 to 80 miles' => 'cycling',
   'volleyball@mixed team volleyball' => 'volleyball',
   'jogging@outside' => 'running',
   'climbing@toprope, indoor climining walls' => 'rock climbing',
   'swimming@swimming while on holiday' => 'swimming',
   'yoga@stretches' => 'hatha yoga',
   'weight training@doing 7 days of workout of intensive weight training for each day i assign a certain muscle group to focus on to ensure a good overall strength' => 'weightlifting',
   'soccer@i played in a short 10 game season of recreational intramural soccer at my college' => 'soccer',
   'swimming@in the open sea with my husband and dog for 30-40 minutes' => 'swimming',
   'walking@with my dog and often a friend in a variety of locations usually for about 45 minutes' => 'walking',
   'eliptical@ussage of eliptical' => 'running',
   'gym@lifting' => 'weightlifting',
   'aerobic@dancing' => 'aerobic exercise',
   'badminton@playing badminton with 3 others in a leisure center' => 'badminton',
   'circuit training@on my own, in a gym, with a week long planned routine' => 'weightlifting',
   'kettle bell@work out with kettle bells' => 'weightlifting',
   'crunches@ab crunches' => 'weightlifting',
   'yoga@at home practice, primarily vinyasa style' => 'hatha yoga',
   'hiking@walking on trails in nature' => 'hiking',
   'field hockey@ncaa division i field hockey' => 'field hockey',
   'running@recreational running to keep in shape for sports, socialize with friends, and explore the area' => 'running',
   'weight lifting@lifting weights in a gym' => 'weightlifting',
   'hiking@hiking on nature trails/mountains' => 'hiking',
   'weight lifting@lifting weights' => 'weightlifting',
   'basketball@i played basketball on a outside court' => 'basketball',
   '5k running@running in one continuous interval a total of 5 kilometers or equivalently 31 miles' => 'running',
   'resistance training@free weights lifting and core exercise' => 'weightlifting',
   'running@casual jogging around city' => 'running',
   'playing soccer@playing soccer recreationally at university' => 'soccer',
   'roller derby@womens flat track roller derby' => 'roller derby',
   'martial arts@primarily jiu-jitsu, but also judo, kick boxing, wing chun, and wrestling' => 'mixed martial arts',
   'soccer@outdoor field soccer' => 'soccer',
   'weightlifting@lifting weights at a gym, not for competitive purposes' => 'weightlifting',
   'cycling@road biking on paved trails' => 'cycling',
   'golf@classic golf' => 'golf',
   'running@long distance' => 'running',
   'football@gaa' => 'football',
   'ultimate frisbee@pick-up ultimate frisbee, 6 on 6' => 'ultimate frisbee',
   'cycling@cycling to and from work (approximately 5 miles on regular roads, includes traffic signals and stop/start events 5-6 times in that distance)' => 'cycling',
   'swimming@lap swimming' => 'swimming',
   'elliptical@machine at the gym' => 'ellipical',
   'speed walking@on high incline on treadmill' => 'running',
   'running@i run outside and enjoy participating in road races i ran the richmond half marathon in november 2016' => 'running',
   'swimming@i swim in an indoor pool for exercise' => 'swimming',
   'recumbent elliptical@elliptical-style cardio machine with recumbent/semi-seated position provides upper and lower body workout' => 'elliptical',
   'strength training@crunches and physical therapy exercises (lower body) with elastic band; upper body with kettlebells' => 'weightlifting',
   'swimming@just recreational swimming' => 'swimming',
   'jogging@jogging for fun' => 'running',
   'swing dancing@lindy hop' => 'dancing',
   'zumba@salsa and bachata' => 'aerobic exercise',
   'racquetball@indoor' => 'racquetball',
   'basketball@pickup' => 'basketball',
   'running@running outside, not timed races or anything though' => 'running',
   'running@casual runs lasting from 2-5 miles, hill sprints up ohill observatory' => 'running',
   'wrestling@club wrestling' => 'wrestling',
   'swimming@competitive swimming on a team, including practices and meets' => 'swimming',
   'frisbee@pick-up ultimate frisbee' => 'ultimate frisbee',
   'weight lifting@lifting weights recreationally' => 'weightlifting',
   'running@jogging for exercise' => 'running',
   'rowing@rowing on the water and associated land training (erging)' => 'rowing',
   'running@regular individual runs of about 4 miles' => 'running',
   'yoga@vinyasa/ flow yoga' => 'hatha yoga',
   'running@i run ~11 minute miles for 1-3 miles at a time' => 'running',
   'running@running outside on the street' => 'running',
   'gymnastics@competitive gymnastics such as they do in the  olympics' => 'invalid',
   'running@running on a treadmill at a constant speed for thirty minutes' => 'running',
   'hiking@walking on and off trails through the woods on small mountains' => 'hiking',
   'lacrosse@womens ncaa division 1 lacrosse' => 'lacrosse',
   'skateboarding@longboarding' => 'skateboarding',
   'horseback riding@eventing- dressage, stadium jumping, and cross country' => 'horseback riding',
   'running@long distance running- 10+ miles' => 'running',
   'basketball@5 v 5 full court' => 'basketball',
   'running@outdoors on streets' => 'running',
   'rock climbing@outdoor top roping, bouldering, and sport leading  indoor bouldering' => 'rock climbing',
   'running@recreational running around the town' => 'running',
   'hiking@hiked a mountain' => 'hiking',
   'rock climbing@climbed at indoor rock wall' => 'rock climbing',
   'strength training@lifting weights' => 'weightlifting',
   'yoga@vinyasa and ashtanga' => 'hatha yoga',
   'dance@lyrical' => 'dance',
   'strength training@lifting weights' => 'weightlifting',
   'yoga@vinyasa and ashtanga' => 'hatha yoga',
   'dance@lyrical' => 'dance',
   'stair stepper@stationary stair stepper machine at the gym' => 'running',
   'running@running on a treadmill inside at the gym' => 'running',
   'swimming@swimming laps' => 'swimming',
   'gymnastics@womens gymnastics' => 'invalid',
   'yoga@vinyasa yoga' => 'hatha yoga',
   'soccer@outdoor soccer; intramural, 8 v 8' => 'soccer',
   'running@outdoor running' => 'running',
   'cycling@solo road cycling (not in a group of other riders)' => 'cycling',
   'weight training@strengthening muscles with free weights, barbell, and machines' => 'weightlifting',
   'running@road running outside' => 'running',
   'swimming@lap swimming in a pool' => 'swimming',
   'running@running at an easy pace for 3-5 miles' => 'running',
   'soccer@american rules' => 'soccer',
   'yoga@heated power vinyasa' => 'hatha yoga',
   'weight lifting@lifting in a gym with both body weight and light weights' => 'weightlifting',
   'swimming@solo swimming - freestyle, breastroke' => 'swimming',
   'gym workout@rowing machine and free weights' => 'invalid',
   'football@americans call it soccer but it should be called "football"' => 'soccer',
   'gymnastics@i compete in womens gymnastics' => 'invalid',
   'gymnastics@i compete in womens gymnastics' => 'invalid',
   'running@5k-10k runs' => 'running',
   'circuit training' => 'weightlifting',
   'run@run on distance of approx 10 km with a 5km per minute pace' => 'running',
   'football@playing outdoor football every sunday with buddies' => 'football',
   'walking@see above' => 'walking',
   'tibetian rites@see above' => 'invalid',  # too vague
   'bodyfit@muscle-building training' => 'weightlifting',
   'hockey@field' => 'field hockey',
   'walking@walking out in the woods' => 'hiking',
   'cycling@ride my bycicle' => 'cycling',
   'circuit training' => 'weightlifting',
   '"running"' => 'running',
   'running@distance running' => 'running',
   'weight training@using weight machines in a gym' => 'weightlifting',
   'swimming@swimming laps and treading water' => 'swimming',
   'tai chi@beginner tai chi classes' => 'tai chi',
   'swimming@recreational lap swimming' => 'swimming',
   'dodgeball@national collegiate dodgeball association version of dodgeball  1 hour long games' => 'dodgeball',
   'running@regular jogging through streets' => 'running',
   'baseball@american baseball' => 'baseball',
   'jumping@leaping up and down' => 'skipping rope',  # similar
   'running@jogging' => 'running',
   'rock climbing@mostly indoor, some outdoor, mostly bouldering, some top-rope, some competitions' => 'rock climbing',
   'volleyball@sand volleyball, non competitive' => 'volleyball',
   'kayaking@recreational solo kayaking on a sit on top kayak in a channel on the fraser river, and sometimes on the fraser river itself' => 'kayaking',
   'walking@walking a trail in a treed area with a stream near my house' => 'hiking',
   'swimming@swim laps of all 4 strokes' => 'swimming',
   'running@2-3 mile run' => 'running',
   'quidditch@we train twice a week' => 'quidditch (sport)',
   'swimming@i train swimming about 3-4 times a week we train for about 15h, swimming between 38 and 42km' => 'swimming',
   'quidditch@collegiate quidditch is a club level sport at uva it has been described as a combination of handball, dodgeball, and rugby' => 'quidditch (sport)',
   'running@solo running, typically on a treadmill' => 'running',
   'ultimate frisbee@club ultimate frisbee team at uva' => 'ultimate frisbee',
   'gym@upper body workouts at a gym on uva grounds, usually with one or more other people' => 'weightlifting',
   'hiking@hiking on paths' => 'hiking',
   'rugby@rugby union - played with 15 players per team and 40 minute halves' => 'rugby',
   'elliptical@using an elliptical at a gym' => 'elliptical',
   'football@americans call it soccer but it should be called football' => 'soccer',
   'body balance@it is mixture of yoga and pilates, but more dynamic and the exercises  have choreographies that fit with specific songs' => 'invalid',  # is this a thing?
   'swimming@swimming laps (crawl or breaststroke or eggbeater)' => 'swimming',
   'aerobic classes@high intensity interval training, insanity classes' => 'aerobic exercise',
   'swimming@i go swimming to do lanes once a week i try to do 50 lanes' => 'swimming',
   'running@moving at a fast momentum this can be done on a treadmill or outside it can be done for fitness or competitively and at different distances' => 'running',
   'yoga@vinyasa, hatha, flow,' => 'hatha yoga',
   'pilates@joseph method pilates' => 'pilates',
   'walking@i walk about a mile to and from my office every once in a while' => 'walking',
   'bicycling@bicycling around the countryside, usually not more than ten miles' => 'cycling',
   'track@sprinting' => 'running',
   'gym traiing@going to the gym and working out regularly' => 'invalid',
   'tennis@tennis where two people hit a ball over the net to each other' => 'tennis',
   'cycling@riding a bicycle in the nature' => 'cycling',
   'bouldering@climbing indoors with friends' => 'rock climbing',
   'dancing@dancing like dancing class as jazz dance' => 'dancing',
   'yoga@yoga, relaxing yoga' => 'hatha yoga',
   'biking@sometimes i mountain bike and other times i road bike i usually go less than 10 miles this year im just trying to do 56 miles a day and 410 vertical feet, road or mountain' => 'cycling',
   'hiking@walking in nature' => 'hiking',
   'hking@mountain hiking' => 'hiking',
   'gym@working out at the gym' => 'invalid',
   'gym, jogging' => 'invalid',
   'dancing@zumba dancing' => 'aerobic exercise',
   'horseback riding@horseback riding in the english discipline' => 'horseback riding',
   'running@running outside on the track' => 'running',
   'swimming@any style of swimming' => 'swimming',
   'dancing@dancing at a party' => 'dancing',
   'basketball@5on5 full court basketball' => 'basketball',
   'weight training@-' => 'weightlifting',
   'snowboarding@-' => 'snowboarding',
   'running@running on a treadmill' => 'running',
   'soccer@soccer, the american kind' => 'soccer',
   'football@football, not american footbal' => 'soccer',
   'running@going for a run' => 'running',
   'walking@going for a walk' => 'walking',
   'hiking@hiking in mountains' => 'hiking',
   'running@i usually run with my dogs, sometimes alone' => 'running',
   'yoga@assorted' => 'hatha yoga',
   'walking@45 minutes, twice daily' => 'walking',
   'gym@attending a variety of exercise machines' => 'invalid',
   'walkin@moving your body in a pace' => 'walking',
   'cycling@road cycling' => 'cycling',
   'gym activity@cardio or resistance training in a gym environment on a range of equipment such as treadmill, elliptical or weight machines' => 'invalid',
   'competitive swimming@competitive swimming to keep active, swimming can become repetitive and in competitive swimming it keep individuals motivated to aim for a goal' => 'swimming',
   'skateboarding@street skateboarding' => 'skateboarding',
   'football@soccer' => 'soccer',
   'working out@working out such as lifting weights or cross fitting' => 'weightlifting',
   'softball@womens fastpitch softball' => 'baseball',
   'running@sprints' => 'running',
   'muay thai@muay thai is a thailand marcial art' => 'muay thai',
   'running@i usually run around 10 km at least three times a week, mainly on mornings depending on the purpuse, i could run on streets or mountain roads (trail)' => 'running',
   'yoga@i do hatha yoga with an instructor once a week, at night' => 'hatha yoga',
   'run@i run half marathons and i completed a full marathon on past october' => 'running',
   'swim@pool swimming' => 'swimming',
   'running@recreational running' => 'running',
   'training@weightlifting and cardio routines' => 'invalid',
   'karate@karate kyokushin and goju ryu' => 'karate',
   'strength training@lifting weights or using fitness machines' => 'weightlifting',
   'skiing@skiing down a mountain on alpine skis' => 'snow skiing',
   'strength training@intense workout in the gym, bodybuilding' => 'weightlifting',
   'hockey@field hockey' => 'field hockey',
   'gym@using weights, cardio' => 'invalid',
   'tennis@indoor tennis' => 'tennis',
   'hockey@ice hockey' => 'ice hockey',
   'gym@lifting weights, running, spinning, yoga' => 'invalid',
   'running@running in linger distances (marathon)' => 'running',
   'cycling@indoor spin class, road bikes' => 'cycling',
   'running@daily 5k' => 'running',
   'rock climbing@indoor and outdoor, bouldering, top rope, and sport climbing' => 'rock climbing',
   'ice skating@skating around on ice' => 'ice skating',
   'weight lifting@lifting weights and getting a pump' => 'weightlifting',
   'kayaking@long-distance river and open water >3 hrs at a time' => 'kayaking',
   'running@jogging in a park' => 'running',
   'tennis@singles and doubles at a moderate intensity' => 'tennis',
   'bike@mountain bike' => 'cycling',  # split into cycling and mountain biking? TODO
   'running@jogging 2-3 miles at a steady pace' => 'running',
   'basketball@playing 3 on 3 basketball on a half-court' => 'basketball',
   'cheerleading@competitive cheerleading' => 'cheerleading',
   'swimming@swimming in a pool, not outside' => 'swimming',
   'hiking@hiking with my dog, walking through the countryside' => 'hiking',
   'football@gridiron football' => 'football',
   'weight lifting@lifting weights for all muscle areas of the body ,including squats, hammer curls, deadlifts, shoulder press, and so on' => 'weightlifting',
   'running@running outside on the road/sidewalk' => 'running',
   'swimming@swimming in a regulation size pool indoors' => 'swimming',
   'running@running as a form of cardio workout (mostly 12- 15km), sometimes i participate in half-marathons' => 'running',
   'running@ran distances between 1-4 miles at quick pace and sprints' => 'running',
   'tae bo@tae bo is a full body workout, combining martial arts, boxing, and elements of dance, set to fast pace music to form this intense cardio workout,' => 'aerobic exercise',
   'running@cross-country running' => 'running',
   'gym@running' => 'running',
   'rpm@classes at the gym' => 'aerobic exercise',  # or cycling? TODO
   'aerials (trapeze)@static trapeze and lyra' => 'trapeze',
   'inline skate@otherwise known as rollerblading  distance rollerblading' => 'inline skating',
   'tennis@i played tennis with my partner - we did not use a real court but we rallied the ball back and forth outside near our house on the concrete' => 'tennis',
   'football@it was not an official game but again more of a kick about outside with two of us' => 'soccer',
   'tennis@singles tennis match best of 3 sets causal but competitive game with a friend 15 hours' => 'tennis',
   'soccer@5 versus 5 soccer match lasting 2 hours' => 'soccer',
   'badminton@singles and doubles badminton' => 'badminton',
   'yoga@yoga/pilates mix, yoga for runners, yoga for relaxing' => 'hatha yoga',
   'running@short distance street running' => 'running',
   'swimming@swimming lengths in pool' => 'swimming',
   'running@10k road races' => 'running',
   'running@running 10k road and cross country races' => 'running',
   'cycling@cycling with family on road and off road' => 'cycling',
   'gym@weight lifting' => 'weightlifting',
   'running@just running' => 'running',
   'yoga@yoga at studio and at home' => 'hatha yoga',
   'football@association football, ie soccer in usa' => 'soccer',
   'running@jogging, casual runs to maintain fitness' => 'running',
   'yoga@self practice at home' => 'hatha yoga',
   'walking@outdoor' => 'walking',
   'gym@<iron bars' => 'weightlifting',
   'running@casual jogging/running' => 'running',
   'swimming@solo lane swimming' => 'swimming',
   'walking@15 hour walk' => 'walking',
   'bike riding@1 hour push-bike ride' => 'cycling',
   'gym activity@cycling, treadmill and yoga stretching' => 'invalid',
   'skiing@alpine skiing' => 'snow skiing',
   'swimming@lane swimming' => 'swimming',
   'cross country@running' => 'running',
   'track@distance track' => 'running',
   'soccer@i play competitive soccer' => 'soccer',
   'basketball@i play basketball for fun' => 'basketball',
   'skiing@slide of mountains with snow' => 'snow skiing',
   'running@go on the street and go faster than walking' => 'running',
   'running@going for a run for 1-2 hours; outside' => 'running',
   'working out@circle training in the gym; mostly bodywight training; 1-3 circles and 6-9 exercises per circly' => 'weightlifting',
   'pilates@follow the teacher in a group on a pilates bed, all sorts of slow exact movements that you have to hold' => 'pilates',
   'swim@forward swimming stokes' => 'swimming',
   'power lifting@cleans, jerks, snatch' => 'weightlifting',
   'working out in the gym@light free weight exercises, cardio, machines, kettle bell' => 'invalid',
   'dancing@salsa' => 'dancing',
   'martial arts@karate' => 'karate',
   'poi@it is a juggling equipment, that involves 2 balls in the end of a string that you waving around yourself' => 'poi (performance art)',
   'crosstraining@crosstrainer at home' => 'elliptical',
   'yoga@hatha yoga' => 'hatha yoga',
   'gymnastics@aerial silks' => 'aerial silk',
   'yoga@in class with a teacher, using yoga mats' => 'hatha yoga',
   'hiking@outside, with backpacks' => 'hiking',
   'yoga@hatha, nidra, balancing, breathing piyo' => 'hatha yoga',
   'swimming@swimming pool: brass, back stroke' => 'swimming',
   'jijp@jjpjjojo' => 'invalid',
   'inline skate@otherwise known as rollerblading distance rollerblading' => 'inline skating',
   'rock climbing@outdoor top roping, bouldering, and sport leading indoor bouldering' => 'rock climbing',
   'working@gardening logging (cuting, woodwork) digging and builduing' => 'gardening',
   'martial arts@taekwondo - mostly kicking brazilian jiu jitsu - ground based grappling/submission wrestling mixed martial arts - mix of striking and grappling' => 'mixed martial arts',
   'wrestling@freestyle wrestling' => 'wrestling',
   'road hockey@road hockey is a variation on ice hockey during which an asphalt surface is used instead of ice a hockey ball is used instead of a puck and running shoes are used instead of skates' => 'road hockey',
   'working@gardening  logging (cuting, woodwork)  digging and builduing' => 'gardening',
   'tennis@singles and doubles tennis' => 'tennis',
   'running@running on some kilometres' => 'running',
   'football@play for school team' => 'football',
   'volleyball@recreational, not competitive, volleyball' => 'volleyball',
   'martials arts@i practice taekwondo it is a type of martial arts that involves shouting a lot for stimulating the player it is accompanied with different forms of risk and body could be damaged atimes' => 'mixed martial arts',
   'swimming@it is a style of swimming that you do on your front, moving your arms and legs away from your body' => 'swimming',
   'track@mile runner' => 'running',
   'tennis@playing a tennis match ncaa d1 rules' => 'tennis',
   'running@cross country distance running' => 'running',
   'gym@lifting and running' => 'invalid',
   'swimming@pool swimming' => 'swimming',
   'basketball@the game of basektball played with 5 players on your team against another 5 players in the gym' => 'basketball',
   'volleyball@canadian indoor volleyball' => 'volleyball',
   'netball@played netball for a 15h duration, weekly activity' => 'netball',
   'aikido@did aikido for a 15h duration, weekly activity' => 'mixed martial arts',
   'gymnastics@vault, floor, balance beam, and bars' => 'artistic gymnastics',
   'basketball@team basketball' => 'basketball',
   'golf@18 hole golf' => 'golf',
   'running@trail running in the foothills of the rockey mountains' => 'running',
   'soccer@soccer at an indoor soccer facility' => 'soccer',
   'running@i ran a couple laps around the park' => 'running',
   'swimming@i took a swam in the lake after running' => 'swimming',
   'weight lifting@i lift weights in a gym' => 'weightlifting',
   'isometrics@bodyweight exercises at home' => 'isometric exercise',
   'dancing@hip hop dancing' => 'dancing',
   'walking@i went out for a walk in the woods on a natural trail' => 'walking',
   'ice skating@i walked to the lake and went ice skating on the frozen lake with my kids' => 'ice skating',
   'basketball@5v5 basketball' => 'basketball',
   'hiking@i go on mountain hiking trips' => 'hiking',
   'football@tag football' => 'flag football', #probably
   'running@its really useful to maintain our body fit' => 'running',
   'swimming@i swim daily on morning time to maintain my body healthy' => 'swimming',
   'elliptical@elliptical machine' => 'elliptical',
   'cricket@i like that gym workouting in carefully' => 'invalid',
   'foodball@foodball is very energytic play' => 'football',
   'foot ball@football mean soccer is always move and running in players, player is physical activity is very healthy' => 'soccer',
   'swimming@this is swimming activity is very strong my body condition' => 'swimming',
   'jimnastic@exercise on bar' => 'artistic gymnastics',
   'running@running on play ground' => 'running',
   'running@football' => 'running',
   'running@i ran the treadmill at gym' => 'running',
   'weight lift@i lift weights at gym' => 'weightlifting',
   'yoga@meditative yoga' => 'meditation',
   'push up@' => 'calisthenics',
   'softball@softball, played on a competitive team in a local league' => 'baseball',
   'gym@gym, lifting weights, squats, deadlifts, curls' => 'weightlifting',
   'swimming@hockey' => 'swimming',
   'running@hockey' => 'running',
   'softball@softball, mens league outside on a regular field' => 'baseball',
   'basketball@in a full-sized gym, pickup games' => 'basketball',
   'basketball@five on five basketball in the gym where i work out' => 'basketball',
   'tennis@one on one tennis at the tennis court inside my local gym' => 'tennis',
   'tennis@my wife and i play weekly for exercise, both as singles and doubles with each other and sometimes against each other' => 'tennis',
   'volleyball@when we go to the beach here in  florida i get involved with pickup games of volleyball on the beach' => 'volleyball',
   'drawing,singing@chess' => 'invalid',
   'reading,swimming@cricket' => 'invalid',
   'drawing,running@cricket,chess' => 'invalid',
   'writing@cricket,chess' => 'invalid',
   'swimming, football@front crawl for swimming  push kick for football' => 'invalid',
   'gym and cricket@lifting weights for gym  strategy of batting for cricket' => 'invalid',
   'running,reading books@watching tv' => 'invalid',
   'magic,singing' => 'invalid',
   'running & jocking@ground & gym' => 'invalid',
   'swimming & physical excercice@football & throuhball' => 'invalid',
   'basketball@i went to a court with my friend in which we shot the ball around for a little bit then we played a couple quick games of one on one' => 'basketball',
   'tennis@met up with another friend of mine and played tennis for like two hours' => 'tennis',
   'jogging@i went jogging a few times a week with my cousin or alone most times i went outside, but a few times i used a treadmill inside' => 'running',
   'swimming@i went swimming' => 'swimming',
   'cycling@cycling race' => 'cycling',
   'running@marathon run' => 'running',
   'jogging@jogging outside' => 'running',
   'swimming@swimming in the ocean' => 'swimming',
   'running@park' => 'running',
   'walking@baseball' => 'invalid',
   'walking with a partner@i engaged in a walking activity with a friend-we had challenged each other to walk at least 30 minutes a day  we succeeded in getting our time in  we walked for 30 minutes around a park area in a shopping area' => 'walking',
   'running@i took a run with the same friend  we did our running activity in the same park area as the shopping center' => 'running',
   'magic,singing' => 'invalid',
   '100 mile bicycle ride@charity ride of 100 mile ride in cuyahoga national park' => 'cycling',
   '2 mile walk@during summer i do a fast walk that averages two miles' => 'walking',
   'swimming@gym' => 'swimming',
   'gym@hocky' => 'invalid',
   'running@food ball' => 'invalid',
   'swimming@food ball' => 'invalid',
   'cricket@played in a  cricket match arranged by my community' => 'cricket',
   'tennis@played tennis match at my club' => 'tennis',
   'walking@walking at a brisk pace in a park' => 'walking',
   'hiking@hiking in woods' => 'hiking',
   'cricket@played game of cricket' => 'cricket',
   'football@football here means soccer' => 'soccer',
   'running@running and exercises during my morning walk i run 3 kms and walk 3 kms i also do different exercises and yoga related to different body parts' => 'invalid',
   'yoga@i also do yoga for smooth functioning of my body' => 'hatha yoga',
   'push up@push the ground so your body goes up' => 'calisthenics',
   'stretching@move your body around slowly' => 'stretching',
   'singing@swimming' => 'invalid',
   'singing@chess' => 'invalid',
   'running,swimming@tennis' => 'invalid',
   'football,vollet ball@soccer' => 'invalid',
   'boxing@sparring' => 'boxing',
   'basketball@rec league' => 'basketball',
   'jogging@jogging around the neighborhood' => 'running',
   'basketball@basketball with a hoop' => 'basketball',
   'yoga@yoga is a physical and mental activity to release stress and improve our health' => 'hatha yoga',
   'badminton@badminton is a sport played using racquets to hit a shuttlecock across a net' => 'badminton',
   'golf@i play 18 holes of golf about 20 times a year' => 'golf',
   'running@i run 3-6 miles 1-3 times/ week' => 'running',
   'cricket@playground' => 'cricket',
   'exercise@gym' => 'invalid',
   'walking@i walk to the store and walk my dog always' => 'walking',
   'cleaning@i take the weekend to clean my house' => 'cleaning',
   'hiking@hiking in the woods and through a waterfall' => 'hiking',
   'running@road running for exercise' => 'running',
   'soccer@i play soccer outside we play on the grass instead of in a gym' => 'soccer',
   'tae kwon doe@i participate in tae kwon doe in a dojo with others its a type of martial art' => 'taekwondo',
   'gym@running & walking' => 'invalid',
   'yoga@sun salutations & low lunge' => 'hatha yoga',
   'bowling@i belong to a bowling league, 10 pin' => 'bowling',
   'swimming@i swim twice a week at the local ymca' => 'swimming',
   'golf@i played a full 18 holes of golf walking the course' => 'golf',
   'walleyball@its similar to volleyball but played on a racquetball court with a smaller ball' => 'walleyball',
   'tennis@hitting a ball with a tennis racket' => 'tennis',
   'basketball@street basketball' => 'basketball',
   'frisbee golf@park/wooden terrain play' => 'disc golf',
   'swimming (indoor)@laps and recreational fun' => 'swimming',
   'swimming@indoor swimming' => 'swimming',
   'mark@hard workout ,and wait lifting' => 'invalid',
   'running@long run' => 'running',
   'sports@volley ball' => 'volleyball',
   'walking@gym' => 'walking',
   'sports@basketball' => 'basketball',
   'golf@playing golf on the golf course (usually walking instead of riding in a cart) and hitting thousands of balls at the driving range' => 'golf',
   'martial arts@i have a black belt in shotokan karate and practice and spar regularly' => 'Shotokan',
   'mud games competition@obstacle course through rough terrain and mud' => 'obstacle course',
   'horse back riding@riding horses in a structured and professional manner' => 'horseback riding',
   'running@outside for a mile' => 'running',
   'gym@using the eleptical' => 'running',
   'tennis@i played tennis at my local tennis court with a friend i actually played numerous times last summer and fall' => 'tennis',
   'running@i run every morning before i go to work usually' => 'running',
   'jogging@hold your head high, centered between your shoulders, and your back straight imagine your body is hanging from a string that is attached to the top of your head do not lean your head too far forward; this can lead to fatigue and tightness in the neck, as well as the shoulders, back and even your hamstrings while a backward lean is not as common, doing so puts greater tension on your back and legs, so avoid that, too  focus your gaze approximately 30-40 yards in front of you looking down when running can lead to greater strain on the neck muscles and spine, which can lead to fatigue especially in the latter part of your run' => 'running',
   'running@running for a fixed distance within a fixed time in a park or on a jogging track can effectively improve your specific run-endurance and your control of the running pace run rhythmically in a relaxed but energetic manner the intensity of a run should be set according to your physical ability and objectives of training the duration, distance and intensity of your training may gradually increase depending on your physical conditions' => 'running',
   'swimming@i like swimming' => 'swimming',
   'running@i like running' => 'running',
   'golfing@every weekend i try and get out to play a round of 18 holes of golf with some friends at the local golf course' => 'golf',
   'working out in gym@a few times a week i go to my condos gym and work out on the machines' => 'invalid',
   'gym@riding a stationary bike' => 'stationary bicycle',
   'gymnasium@gym' => 'invalid',
   'work out@to fit the muscles' => 'invalid',
   'weight lifting@recreational weight lifting in order to reach physique and strength goals' => 'weightlifting',
   'running@endurance training by running i want to build my cardiovascular health' => 'running',
   'disc golf@disc golf aka frisbee golf on an outdoor course' => 'disc golf',
   'basketball@basketball on a court with one side' => 'basketball',
   'cycling@i ride my bicycle' => 'cycling',
   'fishing@i like going to river and fishing' => 'fishing',
   'basketball@including drills that each individual player compete with one another, 5 vs 5 exhibition' => 'basketball',
   'soccer@regular soccer game with 11 players on each team' => 'soccer',
   'basketball@pick-up basketball games (5 on 5)' => 'basketball',
   'running@long distance jogging (3-10 miles)' => 'running',
   'baseball@i play infield for my baseball team' => 'baseball',
   'gym@i participate in a weightlifting program every week day' => 'weightlifting',
   'running@i ran through a suburban neighborhood/commercial area' => 'running',
   'swimming@i swam laps at a gym lap pool' => 'swimming',
   'cross country@running outside' => 'running',
   'cycling@a good quality bicycle can be expensive, although i dont have to spend a lot of money on one if i just starting out i need to regularly check my bicycle for signs of wear and tear and fix it if necessary' => 'cycling',
   'running@running is a weight-bearing activity so it helps to build strong bones its one of the best ways to increase your cardiovascular fitness and burns lots of kilojoules the need for equipment is minimal, although it is recommended i buy a good pair of running shoes' => 'running',
   'rock a %0a ++a sa a fa !@i participated in indoor rock climbing in my high school a >a 1/2a a 2' => 'rock climbing',
   'a 1/2a *a >a@more of a pilates or exercise a 1/2a *a >a' => 'pilates',
   'swimming@i did 15 laps around the pool' => 'swimming',
   'dancing@ballet dancing' => 'dancing',
   'cycling@walking' => 'cycling',
   'swimming@shuttle' => 'swimming',
   'swimming@swimming laps in a pool at a gym' => 'swimming',
   'tennis@played singles tennis against a friend' => 'tennis',
   'running@excercise' => 'running',
   'walking@excecising' => 'walking',
   'running@indoor and out door running/training' => 'running',
   '5k foot race@outdoor 5k running race' => 'running',
   'basketball@street basketball' => 'basketball',
   'running@running laps around the neighborhood block' => 'running',
   'basketball@full court basketball game outside at the park' => 'basketball',
   'baseball@baseball game outside at the park' => 'baseball',
   'walking@i walk the dog for one mile each day' => 'walking',
   'jogging@i jog for a mile each day' => 'running',
   'riding a bike@riding a bike on a bike trail' => 'cycling',
   'dancing@zumba dance aerobics' => 'aerobic exercise',
   'skating@riding a longboard cross country' => 'skateboarding',
   'running@weight lift' => 'running',
   'skipping@jumping' => 'skipping rope',
   'walking@a very calm excercise, and very benficial' => 'walking',
   'biking@its a way to transport, riding on a bike,' => 'cycling',
   'running@training for 5k' => 'running',
   'volleyball@court volleyball' => 'volleyball',
   'dancing@to clarify i mean zumba' => 'aerobic exercise',
   'running and swimming@hockey' => 'invalid',
   'jumbing and exercise@football' => 'invalid',
   'swam laps@na' => 'swimming',
   'mountain biking@heavy trail riding into tall foothills (high degree inclines)' => 'mountain biking',
   'tennis@mixed doubles on hard court' => 'tennis',
   'curling@i played curling which is a sport on the ice in which you throw stones down an alley and aim for a specific point while attempting to knock your opponents stones further away' => 'curling',
   'quidditch@i played muggle quidditch which players run around on a field straddling broomsticks and play the sport described in the harry potter books' => 'quidditch (sport)',
   'soccer@played soccer outside with family' => 'soccer',
   'yoga@did hot yoga at the local gym' => 'hatha yoga',
   'aqua aerobics@aqua zumba' => 'aerobic exercise',  # split? TODO
   'jugging and running@hockey' => 'invalid',
   'swimming@footabll' => 'invalid',
   'walking@i walk one-half mile to one mile 4 times a week' => 'walking',
   'running@run as long as i can, usually though a park' => 'running',
   'swimming@i always swim with friends and family' => 'swimming',
   'boxing@i see it as a aerobic exercise' => 'boxing',
   'skiing@when to a mountain and skied down the side of it' => 'skiing',
   'ultimate frisbee@it is like soccer and football combined with throwing a frisbee around' => 'ultimate frisbee',
   'running@going to the reservoir to run' => 'running',
   'swimming@swimming in my pool' => 'swimming',
   'skipping and running@my favourite activities is running and i daily ran above more than 2kms and i get a healthy' => 'running',
   'my another physical activities is volleyball playing with my friends and i played weekly and i get cheer up when i played volleyball@i played basketball game also,it is the very interesting game for me and i liked very my and i get very fear and get fresh during this game' => 'volleyball',
   'kayaking@17-mile upper cumberland expedition in a tandem kayak with one other person' => 'kayaking',
   'tennis@played singles tennis with my significant other on a hard surface (meaning not clay and not grass)' => 'tennis',
   'hiking@going hiking for miles and miles in the woods' => 'hiking',
   'running@i like to go running anywhere' => 'running',
   'gym@weight lifiting' => 'weightlifting',
   'running@treadmill running' => 'running',
   'gym@i am working in gym in body building workout with daily routine' => 'invalid',
   'swimming@my daily morning activities foot ballit will help to improve body condition' => 'invalid',
   'hiking@i went hiking near the hollywood sign hiking trail in la, ca' => 'hiking',
   'swiiming@i went for a morning swim' => 'swimming',
   'readind, walking@chess' => 'invalid',
   'swimming, running@hockey' => 'invalid',
   'running@running on the street' => 'running',
   'swimming@swimming in my local public club' => 'swimming',
   'running@outdoor, urban running at a moderate pace' => 'running',
   'weight lifting@lifting weights with a bar bell and/or round weight plates includes activities such as deadlifts, squats, bent over rows, shoulder presses, etc' => 'weightlifting',
   'swimming@swimming laps for endurance' => 'swimming',
   'weight lifting@free weight lifts at gym' => 'weightlifting',
   'medication@yoga and excercise' => 'hatha yoga',
   'excercise@running,jokking,long jump' => 'invalid',
   'running@i run at the gym on a treadmill' => 'running',
   'lifting@i lift weights at the gym' => 'weightlifting',
   'weightlifting@i lifted free weights' => 'weightlifting',
   'football@threw an american football around a field to myself and i ran and caught it' => 'football',
   'yoga@i daily practice yoga on early morning' => 'hatha yoga',
   'swimming@swimming is a good exercise' => 'swimming',
   'run@gym' => 'running',
   'eating@rugby' => 'invalid',
   'run@gym' => 'running',
   'eating@football' => 'invalid',
   'jogging@went and jogged around my neighborhood' => 'running',
   'lifting weights@i did 5 reps of benches,and 2 reps of curls' => 'weightlifting',
   'climbing@rock climbing' => 'rock climbing',
   'running@mini marathon running' => 'running',
   'jogging@jogging at morning for refresh' => 'running',
   'swimming@i went to the y and swam for two hours' => 'swimming',
   'running@i ran around the local track at the park' => 'running',
   'gardening@replaced a stone walkway' => 'gardening',
   'biking@regular rides down the natural river bike paths, nature and exercise' => 'cycling',
   'gym@jumping' => 'skipping rope',
   'swimming@diver' => 'swimming',
   'racket ball@played a round of racket ball at my local gym with a close friend' => 'racquetball',
   'played tennis@i often plat tennis on a team with my local health club' => 'tennis',
   'walking@cat walking' => 'walking',
   'basketball@map pointer' => 'basketball',
   'sailboat racing@i raced a laser in a local regatta' => 'regatta',
   'played tennis@i played tennis in a league on wednesday nights i play singles' => 'tennis',
   'basketball@basketball for my college in a college gym we work on practice, real games and just the fundamentals of the game' => 'basketball',
   'lifting weights@in the gym ill go to workout and lift weights such as bench pressing, squats and other weight workouts' => 'weightlifting',
   'cricket@playing cricket one day match' => 'cricket',
   'kabaadi kabaadi@tamilan kabaadi' => 'kabaddi in India',
   'walking briskly@i walked continuously and briskly for about 1 hour per day around a friends property for excersize' => 'walking',
   'gardening activities@i picked berries for about an hour at a time a few times a week, i watered a huge garden a few times and weeded a little too at tines while staying at a friends place' => 'gardening',
   'weight lifting@i lifted heavy weights at the gym i did bench presses, squats, and deadlifts to increase my strength' => 'weightlifting',
   'running@i ran around my neighborhood for exercise' => 'running',
   'hoop dancing@it is a combination of dancing and hula hooping, where the dancer rotates the hoop on all parts of their body, not just the waist like with traditional hula hooping its all about flow or how smoothly you can make from one move to the next' => 'hooping',
   'unicycle@cycling with one wheel, no brake, no gear, no handle bar' => 'unicycling',
   'golf@i play golf in gold courses' => 'golf',
   'running@i run outside' => 'running',
   'hiking@hiking up a mountain' => 'hiking',
   'biking@biking on a trail' => 'mountain biking',
   'football@basketball' => 'invalid',
   'soccer@uk soccer' => 'soccer',
   'softball@i play for both mens and co-ed (7 men 3 women) slow pitch softball teams' => 'baseball',
   'tennis@i play mens tennis as well as mens doubles and mixed doubles' => 'tennis',
   'hiking@i go on daily hikes in the woods with my dogs' => 'hiking',
   'biking@i ride my bike 3-5 miles 3 times a week' => 'cycling',
   'cycling, jogging,playing cricket@i go cycling everydayjogging probably 2-3 times per week' => 'invalid',
   'playing cricket@i play cricket at weekendsi dont play for team its kind like street sports' => 'cricket',
   'jogging@i jog on a treadmill' => 'running',
   'yoga@i do it in a classroom setting' => 'hatha yoga',
   'hocey@i belong to an adult hockey league' => 'invalid',
   'cycling@i ride bikes as an exercise and belong to a club' => 'cycling',
   'pushups@pushing on the ground to lift my body up' => 'calisthenics',
   'situps@using your stomach to pull your body up' => 'calisthenics',
   'swimming@went swimming twice a week at the local pool to lose weight' => 'swimming',
   'running@i run 2 miles a day out on the country road we live on' => 'running',
   'basketball@played pickup basketball games outside' => 'basketball',
   'weightlifiting@lifting light weights at home' => 'weightlifting',
   '5k run@i ran several races this year' => 'running',
   'mud run@i ran a mud run with obstacles' => 'obstacle course',
   'running@i run on the roads in my neighborhood' => 'running',
   'walking@i walk with my daughter on sidewalks and around the park' => 'walking',
   'physical activity@n/a' => 'invalid',
   'physical activity@n/a' => 'invalid',
   'i am participate the swimming competition@i am a 100 meter swimming champion' => 'swimming',
   'gym@i need a fitness so i am going to gym regularly' => 'invalid',
   'soccer@playing 11v11 on the soccer field' => 'soccer',
   'gym@weightlifting and cardio' => 'invalid',
   'playing hockey@field hockey' => 'field hockey',
   'playing cricket@cricket' => 'cricket',
   'running swimming@cricket' => 'invalid',
   'swimming@playball' => 'invalid',
   'science@health' => 'invalid',
   'sports@health' => 'invalid',
   'science@health' => 'invalid',
   'sports@health' => 'invalid',
   'gym@hockey' => 'invalid',
   'wallyball@throughball' => 'invalid',
   'hockey@ice hokey' => 'ice hockey',
   'science@health' => 'invalid',
   'sports@health' => 'invalid',
   'swimming -- competitive@regular physical activity helps improve your overall health and fitness' => 'swimming',
   'backpacking or mountain climbing@swimming, weeding or pruning' => 'invalid',
   'cricket@cricket ground' => 'cricket',
   'valliball@area valliball ground' => 'volleyball',
   'swimming@football' => 'invalid',
   'walking@morning 5am to 530am walking regularly' => 'walking',
   'workout@cricket' => 'cricket',
   'cycling@swim' => 'invalid',
   'basketball@played in a sponsored team tournament' => 'basketball',
   'horseshoes@i played horseshoes in a team tournament' => 'horseshoes',
   'i participated in hockey at state level@field hockey' => 'field hockey',
   'i play hand ball@i am soccer in game' => 'invalid',
   'swimming@in swimming i aimed to reach the goal in the ,minimum time period' => 'swimming',
   'cycling@in cycling i try to i reach the high level distance ' => 'cycling',
   'i participated in running@last month i participated in running and also i won the first price' => 'running',
   'swimming@four months before i participated in swimming and got second price' => 'swimming',
   'tracking@mountain tracking' => 'invalid',
   'playing@cricket' => 'invalid',
   'metesion@improvement the health grown' => 'invalid',
   'football@n/a' => 'football',
   'jog@road jog' => 'running',
   'none@n/a' => 'invalid',
   'walking@mall walking' => 'walking',
   'running@marathon' => 'running',
   'cards playing@played card with other friends' => 'card game',
   'cut down a tree@cut down a tree near my house myself' => 'gardening',
   'tennis@playing tennis with a friend at the tennis court at their apartment' => 'tennis',
   'frisbee golf@playing frisbee golf in a park with friends' => 'disc golf',
   'swimming@swimming in the pool regularly' => 'swimming',
   'jogging@jogging in the woods' => 'running',
   'volleyball@i am a member of a womans volleyball team' => 'volleyball',
   'gym@i r=tame a zumba class every week' => 'aerobic exercise',
   'judo@i practice judo as a 5 dan' => 'judo',
   'weight training@i am involved in weekly weight training exercises' => 'weightlifting',
   'skipping@gym-weightlifting' => 'invaid',
   'jump@basket ball' => 'basketball',
   'played cricket@played in a school ground' => 'cricket',
   'running@attended a charity marathon running at my town' => 'running',
   'skipping@gym-weight lifting' => 'invalid',
   'jump@basket ball' => 'basketball',
   'running@gym' => 'running',
   'criket@vally ball' => 'invalid',
   'running@going from one place to another on a high speed' => 'running',
   'lifting things@taking things from one place to another by lifting them' => 'weightlifting',
   'swimming, jumping@gym' => 'invalid',
   'running, cycling@cycling is good for health' => 'invalid',
   'walk@martial arts' => 'invalid',
   'runing@cricket' => 'invalid',
   'skipping with a rope@jump rope to skip your full body' => 'skipping rope',
   'cycling@cycling is very good exercise' => 'cycling',
   'walking@just walking for some kilometers in the evening' => 'walking',
   'cricket@cricket is similar to baseball' => 'cricket',
   'running@gym' => 'running',
   'swimming@vally ball' => 'invalid',
   'cricket@im very hard hitting batsman cricket ball and rubber ball' => 'cricket',
   'football@australian rules football' => 'Australian football',
   'running@racing for time and distane' => 'running',
   'gym@lifting weights and doing cardio' => 'invalid',
   'jogging@running' => 'running',
   'running@cross country running' => 'running',
   'yoga@yin yoga, restorative yoga, kundalini yoga' => 'hatha yoga',
   'walking@power walking' => 'walking',
   'gym@strength training' => 'weightlifting',
   'rugby@i played an intramural rugby game' => 'rugby',
   'swimming@i swam at my local gym' => 'swimming',
   'pushups@pushing yourself off the floor and repeating multiple times' => 'calisthenics',
   'walking@walking at a brisk pace for at least thirty minutes, or for a number of miles' => 'walking',
   'rowing@sweep rowing' => 'rowing',
   'gym@treadmill' => 'running',
   'martial arts@martial arts i use to practice karate every 3 or 4 times a week and run daily in the ground' => 'karate',
   'cricket@weekends i use to play cricket in cricket ball' => 'cricket',
   'basketball@playing basketball at the park' => 'basketball',
   'running@at the gym, i would normally run 65 miles in one hour on the treadmill' => 'running',
   'weighlifting@i would use the dumbells, the assisted lifting machine, and bench press to do deadlifts, and squats' => 'weightlifting',
   'yoga@spiritual  yoga with some stress to body' => 'hatha yoga',
   'gym@formal gym activites' => 'invalid',
   'yoga@spiritual yoga which y\used to stress our body and meditation' => 'hatha yoga',
   'gym@formal exercise' => 'invalid',
   'bicycling@pedaling bicycle for 10+ miles' => 'cycling',
   'weightlifting@olympic-style barbell weightlifting' => 'weightlifting',
   'martial arts@mixed martial arts' => 'mixed martial arts',
   'calisthenics@jumping jacks, push ups, crunches/curl ups' => 'calisthenics',
   'running@daily 30 minutes i was running in the morning' => 'running',
   'swimming@weekly twice i was swimming' => 'swimming',
   'biking@riding a bicycle along trails through parks' => 'cycling',
   'jogging@jogging along trails in the park' => 'running',
   'gym@went to gym at my apartment complex i went on the treadmill' => 'running',
   'hike@i went on a 5 mile walk' => 'walking',
   'walking@long distance' => 'walking',
   'running@i typically run one to two miles most days, outside if nice out or on  the treadmill' => 'running',
   'weight lifting@i complete a lifting program on alternating days' => 'weightlifting',
   'swimming@i swam in an adult swim meet' => 'swimming',
   'horseback riding@horse show with my equestrian club' => 'horseback riding',
   'basketball@one on one game of basketball with a friend' => 'basketball',
   'swimming@race against a friend at a lake' => 'swimming',
   'basketball@played some solo basketball, took shots for fun and exercise for about half an hour' => 'basketball',
   'swimming@swam some laps in the pool' => 'swimming',
   'golf@i am a fairly regular golfer i play with friends and family and sometime play alone' => 'golf',
   'basketball@i have some younger homies who think they can hoop and we play at the park down from my house i whip that ass i am still a good basketball player' => 'basketball',
   'cycling@cycling-pedaling a cycle in both cock wise and anti clock wise direction' => 'cycling',
   'walking@walking-walking fast for at least an hour till we get sweat' => 'walking',
   'gettogether sports activity, we as a group gathered together after 10 years and celebrated the day with sports@running race, we played the game very well with intrest' => 'invalid',
   'gym@the activity is short but worthable' => 'invalid',
   'basket ball tournament@i and some of my friends entered a basket ball tournament where we played for a charity' => 'basketball',
   'weight lifting  competitively@i go to the gym monthly to compete with others at weight lifting' => 'weightlifting',
   'basketball@playing for a local league' => 'basketball',
   'running@daily exercise alone running 5 miles' => 'running',
   'basketball@i go to an indoor gym and play a couple pick up basketball game with other members for a couple hours' => 'basketball',
   'softball@i am in a outdoor softball league where we play for 2 months during the summer against other teams in the league' => 'baseball',
   'bowling@i play bowling' => 'bowling',
   'rowing@i row a boat' => 'rowing',
   'running@i run at least 4 times a week i do it for my health but i also do races it is fun for me and also oddly relaxing' => 'running',
   'group crossfit@i have a group i work out with most afternoons we work out togather doing crossfit and having fun' => 'invalid',
   'kabbadi@kabbadi at match practice' => 'kabaddi in India',
   'running@competitive at our city' => 'running',
   'bowling@i am in a weekly bowling league on saturday mornings' => 'bowling',
   'basketball@i play the occasional pickup basketball game with the guys around town here' => 'basketball',
   'handkop and slowly runner so some feel about me@gym is daily excerise and developed body machle' => 'invalid',
   'good excerise@football' => 'football',
   'swimming@swim in water, maintained structure and its very maintain stamina' => 'swimming',
   'running@running is very healthy to avoid colestrol' => 'running',
   'swimming@swim in water, maintained structure and its very maintain stamina' => 'swimming',
   'running@running is very healthy to avoid colestrol' => 'running',
   'dance@i use to do hiphop and salsa' => 'dance',
   'tennis@table tennis' => 'table tennis',
   'running@i ran several 5k races during the year' => 'running',
   'paintball@i spent a saturday afternoon running between obstacles and being shot with a paintball gun' => 'paintball',
   'bowling@league bowling 3 nights a week competitive' => 'bowling',
   'hiking@went hiking in the grand canyon, easy trails' => 'hiking',
   'running@i run 2 miles a day outside after dinner' => 'running',
   'tennis@i play tennis with my wife every weekend we play a 3 set match' => 'tennis',
   'weight lifting@all kinds of weight lifting curls, deadlifts, squats, tricep extensions, etc' => 'weightlifting',
   'bike riding@i ride my exercise bike an home for 40 minutes a day' => 'cycling',
   'biking@riding my bike' => 'cycling',
   'hiking@hiking with other hikers' => 'hiking',
   'cricket@basically im a good bowler' => 'cricket',
   'tennis@basically i am a clay court player' => 'tennis',
   'yoga@yoga is simple practice or an exercise, including breath control, simple meditation, and the adoption of specific bodily postures, is widely practised for health and relaxation' => 'hatha yoga',
   'cricket@an open-air game played on a large grass field with ball, bats, and two wickets, between teams of eleven players, the object of the game being to score more runs than the opposition' => 'cricket',
   'bike@bike ride' => 'cycling',
   'jump rroping@jump roping' => 'skipping rope',
   'daily 1 hour cycling and 1 hour walking@1-hour cycling' => 'invalid',
   'na@1 hour brisk walking' => 'walking',
   'hiking@i did hiking it is nice around here especially in spring, summer and fall and hiking is fun' => 'hiking',
   'basketball@basketball there is a basketball court close i play at i play with family and friends' => 'basketball',
   'basketball@playing competitive basketball' => 'basketball',
   'swimming@swimming competitions' => 'swimming',
   'swimming@swimming laps in a pool' => 'swimming',
   'rollerskating@rollerskating with roller skates' => 'roller skating',
   'swimming@swimming laps in a pool' => 'swimming',
   'rollerskating@rollerskating with roller skates' => 'roller skating',
   'bicycle riding@i rode my bike for recreation for a couple of hours' => 'cycling',
   'walking@i went for a walk around my neighborhood and beyond' => 'walking',
   'weight lifting@i work out 4 days a week, working each body part one time  i also do 20 to 30 minutes of cardio afterwards' => 'weightlifting',
   'bowling@i do recreational bowling  i am no longer in a league, but do go bowling with my son about once a month' => 'bowling',
   'badminton@i played badminton (singles) in an indoor arena' => 'badminton',
   'beach volleyball@played volleyball at the beach (2 players a side)' => 'volleyball',
   'sports@many games have shuttle, athletics etc' => 'invalid',
   'games@running, skipping' => 'invalid',
   'swimming@swimming in a standard pool' => 'swimming',
   'hiking@light hike up a large hill' => 'hiking',
   'running are most important physical activity@the physical activity are very health- and performance-related fitness' => 'running',
   'cycling are most important physical activity@the physical activity are somatic growth, development, and function of life' => 'cycling',
   'runing@foodball' => 'invalid',
   'swimming@i stayed at a hotel on a business trip the hotel had an indoor pool so i went for a swim before it closed for the night the pool was pretty spacious and swam laps for about 20 minutes' => 'swimming',
   'walking@i found a nice area in a town i was visiting to take a walk in nature it was  a pretty brisk walk for about 30 minutes' => 'walking',
   'obstacle course@spartan race' => 'obstacle course',
   'walking@walking around the block for a half hour' => 'walking',
   'biking@riding my bike around the neighborhood for 30 minutes' => 'cycling',
   'basketball@indoor 5 vs 5 basketball' => 'basketball',
   'frisbee@ultimate frisbee' => 'ultimate frisbee',
   'running@running for 20 minutes a day for 3 days a week outside' => 'running',
   'yoga@various yoga practices in studio and at home' => 'hatha yoga',
   'tennis@i played tennis with a friend of mine a few times last summer and fall' => 'tennis',
   'running@i run every morning' => 'running',
   'basketball@indoor full-court five-on-five basketball' => 'basketball',
   'gym@free weights like dumbbells and barbells' => 'weightlifting',
   'basketball@street basketball i play a 3 vs 3 style game at a local park' => 'basketball',
   'weightlifting@i do weightlifting like deadlifts and squats at the gym' => 'weightlifting',
   'soccer@its commonly known as football or soccer, is a team sport played between two teams of eleven players with a spherical ball' => 'soccer',
   'gym@treadmill, weight lifting' => 'invalid',
   'cricket@i play cricket in a big ground with two other opponent teams' => 'cricket',
   'badminton@uses racket and feather corks to play' => 'badminton',
   'softball league@i played in my companies softball league  we play at the local softball field next to the main college' => 'baseball',
   'weightlifting@i work out 3 days a weak at a private gym next to my home i left weights and use a treadmill' => 'weightlifting',
   'running@i like to go running around the block' => 'running',
   'lifting@going to the gym and lifting weights' => 'weightlifting',
   'swimming and running@ice hockey' => 'invalid',
   'physical body and@football is rugby rules' => 'invalid',
   'no pain no gain@ice hockey is most popular in canada, central and eastern europe, scandinavia, russia and the united states ice hockey is the official national winter sport of canada,[1] and enjoys immense popularity; alongside canada, ice hockey is the most popular winter sport in belarus, croatia, the czech republic, finland, latvia, russia, slovakia, sweden, and switzerland north americas national hockey league (nhl) is the highest level for mens ice hockey and the strongest professional ice hockey league in the world the kontinental hockey league (khl) is the highest league in russia and much of eastern europe' => 'invalid',
   'feel good@australian rules football, officially known as australian football, or simply called aussie rules, football or footy, is a contact sport played between two teams of eighteen players on an oval-shaped field, often a modified cricket ground' => 'invalid',
   'runnng@i ran outdoors' => 'running',
   'basketball@basketball in the gym' => 'basketball',
   'swimming@martial arts' => 'invalid',
   'yoga@soccer' => 'invalid',
   'lifting weights@its lifting heavy weights sat the gum' => 'weightlifting',
   'walking at the park@park walking' => 'walking',
   'basketball@i play indoor basketball at the gym with a group of people twice a week' => 'basketball',
   'running@i run about 15 half marathons a month at different venues across the country' => 'running',
   'do you like things organised or prefer a more casual approach? do you like to do things on your own or to be part of a group-based activity?   some issues you may like to consider include: exercising@exercise caution: physical activity and eating disorder recovery  compulsive exercise is often a symptom of eating disorders it is common for a child who is developing an eating disorder to take a su' => 'invalid',
   'choose an indoor activity if you are bothered by weather extremes such as heat or cold enjoyment is the key to sticking to an exercise plan choose an activity you enjoy, not one you think is good f@exercise caution: physical activity and eating disorder recovery  compulsive exercise is often a symptom of eating disorders it is common for a child who is developing an eating disorder to take a su' => 'invalid',
   'running@i frequently participate in recreational, not competitive, running' => 'running',
   'basketball@at least once or twice a month, i play recreational basketball with friends and/or pickup games' => 'basketball',
   'biking@riding a bike, using your legs to propel forward,' => 'cycling',
   'cleaning@cleaning the house' => 'cleaning',
   'biking@riding a bike, using your legs to propel forward,' => 'cycling',
   'cleaning@cleaning the house' => 'cleaning',
   'tennis@weekly tennis club' => 'tennis',
   'raquetball@raquetball with a friend at our nearby gym' => 'racquetball',
   'fat biking@its basically riding my bike in the snow on packed trails  the bike has really wide tires that are studded for traction' => 'mountain biking',
   'splitting wood@i buy logs for firewood  i then cut them with my chainsaw and split them by hand  its a lot of physical labor, but i love doing it' => 'wood splitting',
   'no pain no gain@ice hockey is most popular in canada, central and eastern europe, scandinavia, russia and the united states ice hockey is the official national winter sport of canada,[1] and enjoys immense popularit' => 'invalid',
   'feel good@australian rules football, officially known as australian football, or simply called aussie rules, football or footy, is a contact sport played between two teams of eighteen players on an oval-shaped' => 'invalid',
   'cycling@in cycling i try to i reach the high level distance' => 'cycling',
   'hoop dancing@it is a combination of dancing and hula hooping, where the dancer rotates the hoop on all parts of their body, not just the waist like with traditional hula hooping its all about flow or how smoot' => 'hooping',
   'cycling@a good quality bicycle can be expensive, although i dont have to spend a lot of money on one if i just starting out i need to regularly check my bicycle for signs of wear and tear and fix it if nece' => 'cycling',
   'running@running is a weight-bearing activity so it helps to build strong bones its one of the best ways to increase your cardiovascular fitness and burns lots of kilojoules the need for equipment is minima' => 'running',
   'jogging@hold your head high, centered between your shoulders, and your back straight imagine your body is hanging from a string that is attached to the top of your head do not lean your head too far forward' => 'running',
   'running@running for a fixed distance within a fixed time in a park or on a jogging track can effectively improve your specific run-endurance and your control of the running pace run rhythmically in a relaxed' => 'running',
   'walking with a partner@i engaged in a walking activity with a friend-we had challenged each other to walk at least 30 minutes a day  we succeeded in getting our time in  we walked for 30 minutes around a park area in a sh' => 'walking',
   'gym@powerlifting (squats/deadlifts/bench/overhead press)' => 'weightlifting',
   'hiking@3-5 mile hikes up hilly portions of the appalachian trail near my house' => 'hiking',
   'hockey@i play hockey every week in a competitive ice hockey league' => 'ice hockey',
   'softball@in the spring i play in a work softball league' => 'baseball',
   'treadmill@i work out on a treadmill three or four times a week for 40 minutes and walk 3 miles' => 'running',
   'paddle board@i play paddle board on an outside court with friend once a week when the weather is ok' => 'table tennis',
   'soccer@i kicked the soccer ball at the soccer game' => 'soccer',
   'running@i run on the track' => 'running',
   'tennis@singles tennis, outside' => 'tennis',
   'golf@18 hole golf game against three other opponents' => 'golf',
   'bodybuilding@professional natural bodybuilding contest' => 'weightlifting',
   'boxing@a boxing fitness class' => 'boxing',
   'running@i run outside several times a week' => 'running',
   'volleyball@i play in a small volleyball team' => 'volleyball',
   'biking@i rode an exercise bike' => 'cycling',
   'weight lifting@i lift weights a few times a week' => 'weightlifting',
   'skateboarding@i rode my skateboard around the neighborhood with friends' => 'skateboarding',
   'basketball@i played american basketball' => 'basketball',
   'weight lifting@i weight lift every night and competently lift' => 'weightlifting',
   'soccer@i play soccer in a mens league' => 'soccer',
   'trucking@we group of friends decided to go far a trucking in a nearby hill so we went for it few weeks ago' => 'hiking',
   'cricket@we have a team with office friends we use to play cricket with other teams during weekends' => 'cricket',
   'running@three months back, i participated in trivandrun running event as a part of charitable organization as i have experience in running daily 5kms as a morning exercise' => 'running',
   'yoga@june 21, i participated in yoga performance as a part of international yoga day that performance was around three hours' => 'hatha yoga',
   'walking@i went walking for 30 minutes around my neighborhood' => 'walking',
   'swimming@i went swimming in our town pool for approximately 20 minutes' => 'swimming',
   'running@i ran in a 5k for charity' => 'running',
   'soccer@i played with my rec league soccer club in a few tournaments' => 'soccer',
   'rugby@competitive rugby teams of 7, ourdoor' => 'rugby',
   'volleyball@sand volleyball outdoor on teams of 5; recreational' => 'volleyball',
   'hiking@i hiked a mile long trail to the top of the tallest hill in the county' => 'hiking',
   'working@i lifted and stacked boxes into a truck at my daily job' => 'invalid', # revisit TODO
   'running@running down the street' => 'running',
   'tennis@playing hardcourt tennis, including hitting groundstrokes with a partner to warmup, followed by a one set match' => 'tennis',
   'yoga@60 minute session of silent meditation and deep stretching in various poses to improve circulation and mental health' => 'hatha yoga',
   'bicycling@bicycling commuting' => 'cycling',
   'soccer@outdoor soccer' => 'soccer',
   'cycling@i am doing road cycling regularly individually and group wise as well' => 'cycling',
   'running@i do 5k and 10k running regularly with groups and alone' => 'running',
   'kayaking@paddle in a big body of water' => 'kayaking',
   'hiking@walk thorough the woods for an extended period of time' => 'hiking',
   'jogging@running at a city park for an hour' => 'running',
   'swimming@there is an aquatic center nearby and i go there 3 times a week for a 30 minute swim' => 'swimming',
   'running@running a 5k race' => 'running',
   'cricket match@every weekend i was playing cricket with my area friends the match starts with morning 10 and first half will be complete at 1230 and take a drink break 30 minutes and we continue the match second' => 'cricket',
   'gym@everyday morning i am exercise in gym i am addicted to do it i like to develop my body so i spend everyday morning 45 minutes for weight lifting exercises and evening 45 minutes for cardio exercises' => 'invalid',
   'floor hockey@i play adult co-ed floor hockey with a bunch of other friends  good fun stuff' => 'floor hockey',
   'basketball@i play basketball at the gym  its not organized, but its pretty much every sat afternoon' => 'basketball',
   'weights@lifting weights at the gym' => 'weightlifting',
   'zumba@dance to music with a group of people lead by an instructor' => 'aerobic exercise',
   'running@i run in various events around my area' => 'running',
   'tennis@i enjoy playing tennis with my group of friends we usually play every sat if possible' => 'tennis',
   'running@went running on the treadmill at the gym for 6 miles every day' => 'running',
   'weightlifting@using free weights and assisted machines at the gym' => 'weightlifting',
   'softball@adult male softball' => 'baseball',
   'hockey@ice hockey american' => 'ice hockey',
   'rock climbing@i went rock climbing at a rock climbing gym' => 'rock climbing',
   'jet skiing@i went jet skiing when i was in puerto rico' => 'personal water craft',
   'jogging@early morning walk' => 'running',
   'push ups@i do daily 50 push ups' => 'calisthenics',
   'dance@several friends and i are taking dance classes to learn how to do the thriller dance' => 'dance',
   'walking@three days a week i walk to the park and back, a distance of about 3 miles' => 'walking',
   'running@i ran in a race' => 'running',
   'walking@walked in a fund raiser' => 'walking',
   'yoga@i take yoga classes' => 'hatha yoga',
   'pilates@i take pilates classes' => 'pilates',
   'running@i ran against a group of friends' => 'running',
   'canoeing@me and a group of friends canoed against each other' => 'canoeing',
   'riding bike@ride exercise bike' => 'elliptical',
   'walking@walking outside' => 'walking',
   'running@every weekday i go for a run around my block to stay in shape' => 'running',
   'gym@i am a member of a local gym i usually do cardio, but also do some weight training from time to time' => 'invalid',
   'gym@lifting weights' => 'weightlifting',
   'soccer@7 on 7 indoor soccer' => 'soccer',
   'running@i run on my treadmill 30 minutes a day' => 'running',
   'yoga@i do yoga 3 times a week for relaxation' => 'hatha yoga',
   'swimming@i go swim usually once or twice a week i have a yearly membership in our local gym' => 'swimming',
   'jogging@i try to jog at least once a week, mostly in a morning the last time i went to jog was yesterday' => 'running',
   'running are most important physical activity@growth occurs through a complex, organized process characterized by predictable developmental stages and events' => 'invalid',
   'cycling are most important physical activity@growth, development, and maturation growth is the normal process of increase in size as a result of accretion of tissues characteristic of the organism; growth is the dominant biological activity for' => 'invalid',
   'rowing@american rowing' => 'rowing',
   'running@i have running daily on half hour i enjoy the running regular' => 'running',
   'kapadi@we are kapadi player in india so we have enjoy the kapadi' => 'kabaddi in India',
   'bowling@bowling with friends at the bowling alley' => 'bowling',
   'walking@walking for exercise' => 'walking',
   'running@i have running daily half hour so enjoy the running activities' => 'running',
   'kapadi@kapadi is a very good physical activity  we are play enjoyful' => 'kabaddi in India',
   'walking@daily walking for 45 minutes' => 'walking',
   'jogging@jogging for 30 minutes daily' => 'running',
   'run@baseball' => 'invalid',
   'gym@football' => 'invalid',
   'softball@softball in a league' => 'baseball',
   'hiking@hiking around national parks in michigan over the summer' => 'hiking',
   'cricket@club cricket' => 'cricket',
   'scatting@fitness skates' => 'invalid',
   'sports@shuttle, volley ball' => 'invalid',
   'hockey@cricket' => 'invalid',
   '5k run@ran a 5k glow run' => 'running',
   'rec baseball@played fun games of baseball against other people around my age' => 'baseball',
   'badminton@hitting birdie with raquet over net' => 'badminton',
   'gym@using the stationary bike' => 'stationary bicycle',
   'swim@gym' => 'swimming',
   'soccer@played in pickup games regularly there is a mix of college players and highschool decently competitive' => 'soccer',
   'general exercise with my partner@we do 25 minutes alternating between various exercises including light weights, jumping jacks, running in place, situps, etc' => 'invalid',
   'indoor swimming@i have a gym membership and have been using the indoor pool regularly to train while it is cold outside' => 'swimming',
   'hiking@outdoor hiking on well marked trails with friends' => 'hiking',
   'softball@competitive fast pitch softball league' => 'baseball',
   'basketball@a 3 on 3 basketball league at the local ymca' => 'basketball',
   'running@ran a half marathon' => 'running',
   'walking@brisk walking three times a week' => 'walking',
   'jogging@i did light jogging' => 'running',
   'playing@playing table tennis' => 'table tennis',
   'yoga@i took yoga classes' => 'hatha yoga',
   'pilates@i took pilates classes' => 'pilates',
   'swimming@i swim 10 laps at my pool and then tread water for 20 minutes' => 'swimming',
   'biking@i ride a bike for 6 miles at a time' => 'cycling',
   '10 k race@i ran 2 10k races last summer' => 'running',
   'yoga, one of very famous and healthy physical activity in india@sun salutation or more popularly known as surya namaskar is a set of asanas that massages, detoxifies, and stimulates almost every organ of the human body and brings suppleness to the spine sun salut' => 'hatha yoga',
   'walking and running@morning and evening walking help us to keep healthy' => 'invalid',
   'bicycle race@a long distance bicycle race, 25 miles' => 'cycling',
   'wood chopping competition@you have to cut a 24 inch log with an ax before your opponent' => 'wood splitting',
   'basketball@i played basketball in a low level league' => 'basketball',
   'running@i go running during my lunch breaks around the town' => 'running',
   'running@jogging through my neighborhood' => 'running',
   'weight training@i went to the gym and work out by lifting weights' => 'weightlifting',
   'running@i went outside and ran around the block where i live' => 'running',
   'weightlifting@a weight lifting program for woman called strong curves' => 'weightlifting',
   'kickboxing@cardio kickboxing with a mix of classic boxing moves and cardio like jump roping' => 'kickboxing',
   'walking@i walk around the track at the local high school three days/nights per week' => 'walking',
   'yoga@i went to a yoga class at a local yoga studio because they had a really good groupon' => 'hatha yoga',
   'strength training@weight machines and free weights at the gym' => 'weightlifting',
   'running@going jogging and running' => 'running',
   'tennis@inside clay court' => 'tennis',
   'basketball@rec pickup basketball' => 'basketball',
   'gym@weightlifting 3x/week general strength training' => 'weightlifting',
   'asjdgidhf@hadifhsd' => 'invalid',
   'asdfdw@uhasfdf' => 'invalid',
  );

# Could remove some of these later when we have huge samples. TODO
my %GroupSoloOverride =
  ('aerobic exercise' => 'solo',
   tennis => 'group',
   'hatha yoga' => 'solo',
   walking => 'solo',
   running => 'solo',
   golf => 'group',
   basketball => 'group',
   weightlifting => 'solo',
   swimming => 'solo',
   cycling => 'solo',
   'brazilian jiu jitsu' => 'group',
   'horseback riding' => 'solo',  # the horse doesn't count
   'rock climbing' => 'solo',
   'hiking' => 'solo',
   'dance' => 'group',
   'soccer' => 'group',
   'dancing' => 'group',
   'snow skiing' => 'solo',
   'wrestling' => 'group',
   'mixed martial arts' => 'group',
   calisthenics => 'solo',
   boxing => 'group',
   'disc golf' => 'group',  # probably doesn't matter
   skateboarding => 'solo',
   'racquetball' => 'group',
   'gardening' => 'solo',
   'football' => 'group',
   'kayaking' => 'solo',
   'rowing' => 'solo',
   'mountain biking' => 'solo',
   jogging => 'solo',
   bowling => 'solo',
   karate => 'group',
   'table tennis' => 'group',
   'obstacle course' => 'solo',
   badminton => 'group',
  );

my %LocationMap =
  ("new jersey;use" => 'usa',
   'detroit, mi;michigan' => 'usa',
  );

my %CountryMap =
  (
   'united states' => 'usa',
   'usa' => 'usa',
   'us' => 'usa',
   'u.s.' => 'usa',
   'virginia' => 'usa',
   'canada' => 'canada',
   'ca' => 'canada',
   'germany' => 'germany',
   'uk' => 'united kingdom',
   'united kingdom' => 'united kingdom',
   'england' => 'united kingdom',
   'india' => 'india',
   'ind' => 'india',
   'netherlands' => 'the netherlands',
   'the netherlands' => 'the netherlands',
   'austria' => 'austria',
   'wales' => 'wales',
   'ireland' => 'ireland',
   'israel' => 'israel',
   'switzerland' => 'switzerland',
   'swiss' => 'switzerland',
   'australia' => 'australia',
   'costa rica' => 'costa rica',
   'brazil' => 'brazil',
   'portugal' => 'portugal',
   'sweden' => 'sweden',
   'singapore' => 'singapore',
   'nigeria' => 'nigeria',
   'trinidad and tobago' => 'trinidad and tobago',
   'jamaica' => 'jamaica',
   'a  a  a y=a za' => 'usa',  # braille transliteration?
   'sri lanka' => 'sri lanka',
  );

### BEGIN GLOBAL STATE

our $RCPA_DEMOGRAPHICS;
our $PA1_START;
our $PA2_START;
our $RCPA_START;
our $PAID_START;
our @EndNote;

my %VettedName;
my %NodeInfo;
my %NodeGroupInfo;
my %EdgeInfo;
my $Graph = Graph::Undirected->new();

for my $k (values %LongDict) { $ShortDict{$k} = $k }
for my $k (values %ShortDict, values %LongDict) {
    die "Activity mapped to the empty string" if $k eq '';
    $VettedName{$k} = 1
}

### END GLOBAL STATE

sub trim {
    my ($str) = @_;
    $str =~ s/^\s+//;
    $str =~ s/\s+$//;
    $str
}

sub useNode {
    my ($pa,$solo) = @_;
    return if $pa eq 'invalid';
    if (exists $GroupSoloOverride{$pa}) {
	$solo = $GroupSoloOverride{$pa};
    }
    my $name = join(';', $pa, lc $solo);
    if (!exists $NodeInfo{$name}) {
	$NodeInfo{$name} = { count => 0 };
    }
    ++$NodeInfo{$name}{count};
    ++$NodeGroupInfo{$pa}{$solo};
    $name
}

sub node {
    my ($short, $long, $solo) = @_;
    $long = lc trim($long);
    $long =~ s/\"//g;
    $long =~ s/[\r\n]+/ /g;
    $short = lc trim($short);
    $short =~ s/\"//g;
    $short =~ s/\@//g;
    if ($long eq '' or $short eq $long) {
	if (exists $ShortDict{$short}) {
	    $short = $ShortDict{$short};
	    return useNode($short,$solo);
	} else {
	    print("   '$short' => '',   # short\n");
	}
    } else {
	$long =~ s/\'//g;
	my $full = $short . '@' . $long;
	if (exists $LongDict{$full}) {
	    $short = $LongDict{$full};
	    return useNode($short,$solo);
	}
	if (exists $ShortDict{$short}) {
	    $short = $ShortDict{$short};
	}
	if (exists $VettedName{$short}) {
	    print "   '$full' => '$short',\n";
	} else {
	    print("   '$full' => '',\n");
	}
    }
    undef
}

our @RC_SKILL_MAP =
  ('{{Q9}} requires much more skill than {{Q6}}.',
   '{{Q9}} requires somewhat more skill than {{Q6}}.',
   'Both require roughly equal skill.',
   '{{Q6}} requires somewhat more skill than {{Q9}}.',
   '{{Q6}} requires much more skill than {{Q9}}.');

our @RC_PREDICT_MAP =
  ('{{Q6}} is much more predictable than {{Q9}}.',
   '{{Q6}} is somewhat more predictable than {{Q9}}.',
   'Both offer roughly equal predictability.',
   '{{Q9}} is somewhat more predictable than {{Q6}}.',
   '{{Q9}} is much more predictable than {{Q6}}.');

our @RC_NOVELTY_MAP =
  ('{{Q9}} offers a much more novelty than {{Q6}}.',
   '{{Q9}} offers a somewhat more novelty than {{Q6}}.',
   'Both offer roughly equal novelty.',
   '{{Q6}} offers a somewhat more novelty than {{Q9}}.',
   '{{Q6}} offers a much more novelty than {{Q9}}.');

our @RC_CREATIVE_MAP =
  ('{{Q6}} admits much more creativity than {{Q9}}.',
   '{{Q6}} admits somewhat more creativity than {{Q9}}.',
   'Both admit roughly the same amount of creativity.',
   '{{Q9}} admits somewhat more creativity than {{Q6}}.',
   '{{Q9}} admits much more creativity than {{Q6}}.');

our @RC_COMPLEX_MAP =
  ('{{Q9}} is much more complex than {{Q6}}.',
   '{{Q9}} is somewhat more complex than {{Q6}}.',
   'Both are of roughly equal complexity.',
   '{{Q6}} is somewhat more complex than {{Q9}}.',
   '{{Q6}} is much more complex than {{Q9}}.');

# Removed wording 'rules and' 2017 Jan 30 12:40pm
#
# Anonymous comment: The rules and goals question is double-barreled
# and should be separated. I didn't think running or weightlifting had
# "rules" and the goals can vary from strength to speed to weight
# loss. However I read that statement as inherent rules/goals (like
# football or other gaming sports) so I didn't answer that question
# for long or short-term. You may consider something like 'best
# practices' or techniques if that's what you're getting at.

our @RC_GOAL_MAP =
  ('{{Q6}} has much more clear goals than {{Q9}}.',
   '{{Q6}} has somewhat more clear goals than {{Q9}}.',
   'Both have equally clear goals.',
   '{{Q9}} has somewhat more clear goals than {{Q6}}.',
   '{{Q9}} has much more clear goals than {{Q6}}.');

our @RC_FEEDBACK_MAP =
  ('{{Q9}} has much more immediate feedback than {{Q6}}.',
   '{{Q9}} has somewhat more immediate feedback than {{Q6}}.',
   'Both offer roughly equally immediate feedback.',
   '{{Q6}} has somewhat more immediate feedback than {{Q9}}.',
   '{{Q6}} has much more immediate feedback than {{Q9}}.');

our @RC_CHATTER_MAP =
  ('{{Q6}} turns off my mental chatter much more than {{Q9}}.',
   '{{Q6}} turns off my mental chatter somewhat more than {{Q9}}.',
   'Both turn off my mental chatter to a roughly equal extent.',
   '{{Q9}} turns off my mental chatter somewhat more than {{Q6}}.',
   '{{Q9}} turns off my mental chatter much more than {{Q6}}.');

our @RC_WAITING_MAP =
  ('{{ Q9 }} involves a lot more waiting than {{ Q6 }}.',
   '{{ Q9}} involves a somewhat more waiting than {{ Q6}}.',
   'Both involve about the same amount of waiting.',
   '{{ Q6 }} involves a somewhat more waiting than {{ Q9}}.',
   '{{ Q6 }} involves a lot more waiting than {{ Q9}}.');

our @RC_BODY_MAP =
  ('{{Q6}} involves much more of my body than {{Q9}}.',
   '{{Q6}} involves somewhat more of my body than {{Q9}}.',
   'Both involve my body to a roughly equal extent.',
   '{{Q9}} involves somewhat more of my body than {{Q6}}.',
   '{{Q9}} involves much more of my body than {{Q6}}.');

our @RC_CONTROL_MAP =
  ('{{Q9}} permits much more control than {{Q6}}.',
   '{{Q9}} permits somewhat more control than {{Q6}}.',
   'Both admit roughly equal control.',
   '{{Q6}} permits somewhat more control than {{Q9}}.',
   '{{Q6}} permits much more control than {{Q9}}.');

our @RC_PRESENT_MAP =
  ('{{Q6}} brings me into the present much more than {{Q9}}.',
   '{{Q6}} brings me into the present somewhat more than {{Q9}}.',
   'Both bring me into the present to a roughly equal extent.',
   '{{Q9}} brings me into the present somewhat more than {{Q6}}.',
   '{{Q9}} brings me into the present much more than {{Q6}}.');

our @RC_SPONT_MAP =
  ('{{Q9}} feels effortless compare to {{Q6}} where I have to struggle and force myself.',
   '{{Q9}} feels like less effort than {{Q6}}.',
   'Both require about the same extent of effort (both either effortless or effortful).',
   '{{Q6}} feels like less effort than {{Q9}}.',
   '{{Q6}} feels effortless compare to {{Q9}} where I have to struggle and force myself.');

our @RC_STAKES_MAP =
  ('{{Q6}} has much higher stakes than {{Q9}}.',
   '{{Q6}} has somewhat higher stakes than {{Q9}}.',
   'Both have roughly equal stakes.',
   '{{Q9}} has somewhat higher stakes than {{Q6}}.',
   '{{Q9}} has much higher stakes than {{Q6}}.');

our @RC_EVALUATED_MAP =
  ("During {{Q9}}, I am much more concerned about others' evaluations than during {{Q6}}.",
   "During {{Q9}}, I am somewhat more concerned about others' evaluations than during {{Q6}}.",
   "During both {{Q9}} and {{Q6}}, I have roughly equal concern about others' evaluations.",
   "During {{Q6}}, I am somewhat more concerned about others' evaluations than during {{Q9}}.",
   "During {{Q6}}, I am much more concerned about others' evaluations than during {{Q9}}.");

our @RC_REWARD_MAP =
  ('{{Q6}} is much more rewarding than {{Q9}}.',
   '{{Q6}} is somewhat more rewarding than {{Q9}}.',
   'Both are roughly equally rewarding.',
   '{{Q9}} is somewhat more rewarding than {{Q6}}.',
   '{{Q9}} is much more rewarding than {{Q6}}.');

our @RC_INJURY1_MAP =
  ('{{Q9}} has much more chance of physical injury compare to {{Q6}}.',
   '{{Q9}} has somewhat more chance of physical injury compare to {{Q6}}.',
   'The chance of physical injury is roughly equal.',
   '{{Q6}} has somewhat more chance of physical injury compare to {{Q9}}.',
   '{{Q6}} has much more chance of physical injury compare to {{Q9}}.');

our @RC_INJURY2_MAP =
  ('{{Q6}} has much more chance of serious physical injury compare to {{Q9}}.',
   '{{Q6}} has somewhat more chance of serious physical injury compare to {{Q9}}.',
   'The chance of serious physical injury is roughly equal.',
   '{{Q9}} has somewhat more chance of serious physical injury compare to {{Q6}}.',
   '{{Q9}} has much more chance of serious physical injury compare to {{Q6}}.');

our @RC_MAP_SIGN;

sub cacheMapSign {
    my ($maps) = @_;
    return if scalar(@RC_MAP_SIGN);
    for my $map (@$maps) {
	$map->[0] =~ m/\{\{\s*Q(\d)\s*\}\}/;
	die $1 if ($1 != 6 and $1 != 9);
	my $sign = ($1 == 9)? -1 : 1;
	push @RC_MAP_SIGN, $sign;
    }
    die join('', @RC_MAP_SIGN) if join('', @RC_MAP_SIGN) ne '-11-11-11-11-11-11-11-11-11-11';
}

sub cmpToNum {
    my ($map, $cmp) = @_;
    my $q6 = $PA1_START - 9;
    my $q9 = $PA2_START - 9;
    $cmp =~ s/Q$q6/Q6/g;
    $cmp =~ s/Q$q9/Q9/g;
    return 'NA' if (!length $cmp);
    for my $x (0..4) {
	if ($map->[$x] eq $cmp) {
	    return ($x - 2)
	}
    }
    die "'$cmp' not found";
}

our %SHORT_MASTERY =
  ('Beginner' => 1,
   'Competent amateur' => 2,
   'Expert or professional' => 3);

sub shortenMastery {
    my ($mastery) = @_;
    my $sm = $SHORT_MASTERY{$mastery};
    die $mastery if !defined $sm;
    $sm;
}

sub edge {
    my ($n1, $l1, $n2, $l2, $version, $field, $recno) = @_;
    return if (!defined $n1 or !defined $n2);
    my @k = ($n1,$n2);
    my @sk = sort @k;
    my $sign = $k[0] ne $sk[0]? -1 : 1;
    my $k = join ':', @sk;
    if (!exists $EdgeInfo{$k}) {
	$EdgeInfo{$k} = { n1 => $sk[0], n2 => $sk[1], count => 0 };
    }
    my $info = $EdgeInfo{$k};
    $Graph->add_edge($k[0], $k[1]);
    my @m = (shortenMastery($l1), shortenMastery($l2));
    @m = reverse @m if $sign < 0;
    my @map = (\@RC_SKILL_MAP, \@RC_PREDICT_MAP, \@RC_NOVELTY_MAP, \@RC_CREATIVE_MAP,
	       \@RC_COMPLEX_MAP, \@RC_GOAL_MAP, \@RC_FEEDBACK_MAP, \@RC_GOAL_MAP, \@RC_FEEDBACK_MAP,
	       \@RC_CHATTER_MAP, \@RC_WAITING_MAP, \@RC_BODY_MAP, \@RC_CONTROL_MAP, \@RC_PRESENT_MAP,
	       \@RC_SPONT_MAP, \@RC_STAKES_MAP, \@RC_EVALUATED_MAP, \@RC_REWARD_MAP, \@RC_INJURY1_MAP,
	       \@RC_INJURY2_MAP);
    cacheMapSign(\@map);
    my $rating = [@m];
    for my $x (0..19) {
	my $got = cmpToNum($map[$x], $field->[$RCPA_START + 4 + $x]);
#	if ($x == 1 and $recno == 174) { warn $got }
	if ($got ne 'NA') {
#	    if ($x == 1 and $recno == 174) { warn "$k order ".$sign }
#	    if ($x == 1 and $recno == 174) { warn "map ". $RC_MAP_SIGN[$x] }
	    $got *= $sign * $RC_MAP_SIGN[$x];
	    if ($x == 1 and Date_Cmp($version, "2016-12-25") < 0) {
		# switched from unpredict to predict
		$got *= -1;
#		if ($x == 1 and $recno == 174) { warn "flip old version" }
	    }
#	    if ($x == 1 and $recno == 174) { warn "-> $got" }
	}
	push @$rating, $got;
    }
    push @$rating, $recno;
    push @{ $info->{rating} }, $rating;
}

sub recordDemogr {
    my ($dfh, $csv, $di) = @_;
    my $country = lc(trim($di->[2]));
#    warn join(' ', @$di)."\n";
    if (length $country) {
	my $lmk = lc trim(join(';', $di->[1], $di->[2]));
	if (exists $LocationMap{$lmk}) {
	    $di->[2] = $LocationMap{$lmk};
	} elsif (exists $CountryMap{$country}) {
	    $di->[2] = $CountryMap{$country};
	} else {
	    print "   # ".join(' ', @$di)." # '$lmk'\n";
	    print "   '$country' => '$country',  # country\n";
	}
    }
    $csv->say($dfh, $di);
}

sub loadZip {
    my ($zip, $seqno) = @_;
    my $somezip = Archive::Zip->new();
    $somezip->read( $zip ) == AZ_OK or die $!;
    for my $m ($somezip->membersMatching( '.*\.csv' )) {
	my $fn = $m->fileName();
	if ($fn =~ /(PageOrder|CollectorList)\.csv$/) {
	    # IGNORE
	} elsif ($fn eq 'CSV/Relative characteristics of physical activities.csv') {
	    $RCPA_DEMOGRAPHICS = 9;
	    $PA1_START  = 15;
	    $PA2_START  = 18;
	    $RCPA_START = 21;
	    $PAID_START = undef;
	    my $got = loadRawData($seqno, $m->contents());
	    print "$got\t$fn\n";
	} elsif ($fn eq 'CSV/RCPAMTurk.csv') {
	    $RCPA_DEMOGRAPHICS = 8;
	    $PA1_START  = 14;
	    $PA2_START  = 17;
	    $RCPA_START = 20;
	    $PAID_START = 44;
	    my $got = loadRawData($seqno, $m->contents());
	    print "$got\t$fn\n";
	} else {
	    die $fn;
	}
    }
}

sub complain {
    my ($why, $csv, $cxt) = @_;
    return if $cxt eq '?';
    push @EndNote, join(' ', $why, 'in record', $csv->record_number, "($cxt)");
}

sub loadRawData {
    my ($seqno, $rawData) = @_;
    $rawData =~ tr/\xa0/ /;	# nonbreaking space
    $rawData =~ s/\xc2//gs;	# garbage?

    my $csv = Text::CSV_XS->new ({ keep_meta_info => 1, binary => 1 });
    open my $dfh, ">:encoding(utf8)", "demogr.csv";
    $csv->say($dfh, ['again', 'location', 'country', 'birthyear', 'edu', 'sex']);

    my $fh = IO::String->new($rawData);
    my $ignore_header1 = $csv->getline($fh);
    my $ignore_header2 = $csv->getline($fh);
    my $goodCount = 0;
    while (my $row = $csv->getline($fh)) {
	my @field = unidecode(@$row);
	if (0) {
	    foreach my $col (0 .. $#field) {
		printf "%2d: %s\n", $col, $field[$col];
	    }
	}
	my $recDate = ParseDate($field[2]);
	my $completion_context = '?';
	if (defined $PAID_START) {
	    my $elapsed = DateCalc($recDate, "now");
	    #warn $elapsed;
	    my $code = join '', @field[map { $PAID_START+$_ } 1..3];
	    if (Date_Cmp($elapsed, "3 days") < 0 && length($code) == 6) {
		$completion_context = "$field[2] $code";
	    }
	}
	for my $x ($PA1_START, $PA1_START+1, $PA2_START, $PA2_START+1) {
	    $field[$x] = substr(lc(trim($field[$x])), 0, 200);
	    $field[$x] =~ tr/'"\.//d;
	}
	if ($field[$PA1_START] =~ m/^\s*$/ or $field[$PA2_START] =~ m/^\s*$/) {
	    complain("One or both activities blank", $csv, $completion_context);
	    next
	}
	if ($field[$PA1_START] eq $field[$PA2_START]) {
	    complain("Same short name '$field[$PA1_START]' for both activities ($field[$PA1_START + 1] vs $field[$PA2_START + 1]))", $csv, $completion_context);
	    next
	}
	my $skipped = 0;
	for my $col ($RCPA_START .. ($RCPA_START+21)) {
	    ++$skipped if $field[$col] =~ /^\s*$/;
	}
	if ($skipped > 10) {
	    complain("Too much missing data", $csv, $completion_context);
	    next
	}

	my $n1 = node($field[$PA1_START], $field[$PA1_START + 1], $field[$RCPA_START+0]);
	my $n2 = node($field[$PA2_START], $field[$PA2_START + 1], $field[$RCPA_START+1]);
	if (!defined $n1 or !defined $n2) {
	    complain("Invalid activity pair $field[$PA1_START]@ $field[$PA1_START + 1] and $field[$PA2_START]@ $field[$PA2_START+1]", $csv, $completion_context);
	    next
	}
	if ($n1 eq $n2) {
	    complain("Same activities in pair $field[$PA1_START]@ $field[$PA1_START + 1] and $field[$PA2_START]@ $field[$PA2_START+1]", $csv, $completion_context);
	    next
	}
	my $l1 = $field[$RCPA_START+2];
	my $l2 = $field[$RCPA_START+3];
	if ($l1 eq '' or $l2 eq '') {
	    complain("Missing mastery levels", $csv, $completion_context);
	    next;
	}
	if (defined($PAID_START) and $field[$PAID_START] ne 'Yes') {
	    complain("Opted out", $csv, $completion_context);
	    next
	}
	edge($n1, $l1, $n2, $l2, $recDate, \@field, $seqno.':'.$csv->record_number());
	recordDemogr($dfh, $csv, [ @field[$RCPA_DEMOGRAPHICS .. ($RCPA_DEMOGRAPHICS+5)] ]);
	if ($completion_context ne '?') {
	    push @EndNote, "GOOD $completion_context";
	}
	++$goodCount
    }
    $goodCount
}

sub nodeColor {
    my ($code) = @_;
    if ($code == 1) { '#99cc33' }
    elsif ($code == 2) { '#cc9966' }
    else { '#993333' }
}

sub outputNode {
    my ($i, $id, $rate, $which) = @_;
    my $nk = 'n'.($which+1);
    my $name = simplifyName($i->{$nk});
    my @part = split /;/, $name;
    if (@part == 2) { $name = "$part[0] ($part[1])" }
    my $color = nodeColor($rate->[$which]);
    print "  {id: $id,  label: '$name', color: '$color' },\n";
}

sub outputGraph {
    open my $fh, ">", "pa-browser/rcpa-graph.js";
    my $oldOut = select $fh;

    my $stamp = strftime("%b %d, %Y", localtime());
    print "var RCPA_date = '$stamp';\n";

    my %NodeSet;

    my $NextId = 0;
    my %GNodeId;
    print "var RCPA_nodes = [\n";
    for my $k (sort keys %EdgeInfo) {
	my $i = $EdgeInfo{$k};
	for my $rate (@{$i->{rating}}) {
	    for my $which (0..1) {
		my $nk = 'n'.(1+$which);
		my $k1 = join ';', $i->{$nk}, $rate->[$which];
		if (!exists $GNodeId{$k1}) {
		    $GNodeId{$k1} = ++$NextId;
		    outputNode($i, $GNodeId{$k1}, $rate, $which);
		    if (!exists $NodeSet{ $i->{$nk} }) {
			$NodeSet{ $i->{$nk} } = [0,0,0];
		    }
		    my $rate1 = $rate->[2 + $which];
		    if ($rate1 ne 'NA') {
			$NodeSet{ $i->{$nk} }[ $rate1 ] = $GNodeId{$k1};
		    }
		}
	    }
	}
    }
    print "];\n";

    my %EdgeCount;
    for my $k (sort keys %EdgeInfo) {
	my $i = $EdgeInfo{$k};
	for my $rate (@{$i->{rating}}) {
	    my $k1 = join ';', $i->{n1}, $rate->[0];
	    my $k2 = join ';', $i->{n2}, $rate->[1];
	    ++$EdgeCount{"$k1--$k2"};
	}
    }

    print "var RCPA_edges = [\n";
    for my $k (sort keys %NodeSet) {
	my $set = $NodeSet{$k};
	for my $st (0..1) {
	    next if ($set->[$st] == 0 or $set->[$st+1] == 0);
	    print "  {from: $set->[$st], to: $set->[$st+1], color: { opacity: .5 }, dashes: true },\n";
	}
    }

    for my $k (sort keys %EdgeInfo) {
	my $i = $EdgeInfo{$k};
	for my $rate (@{$i->{rating}}) {
	    my $k1 = join ';', $i->{n1}, $rate->[0];
	    my $k2 = join ';', $i->{n2}, $rate->[1];
	    next if !exists $EdgeCount{"$k1--$k2"};
	    my $count = $EdgeCount{"$k1--$k2"};
	    print "  {from: $GNodeId{$k1}, to: $GNodeId{$k2}, value: $count },\n";
	    delete $EdgeCount{"$k1--$k2"}
	}
    }
    print "];\n";
    select $oldOut;
}

sub outputDebug {
    for my $k (sort keys %NodeInfo) {
	print "$k $NodeInfo{$k}{count}\n";
    }
    for my $k (sort keys %EdgeInfo) {
	print "$k $EdgeInfo{$k}{count}\n";
    }
}

sub simplifyName {
    my ($nn) = @_;
    my @part = split /;/, $nn;
    my $gi = $NodeGroupInfo{ $part[0] };
    if (keys %$gi == 1) {
	return $part[0]
    } else {
	return $nn;
    }
}

sub outputData {
    my $csv = Text::CSV_XS->new ({ binary => 1, auto_diag => 1 });
    open my $fh, ">:encoding(utf8)", "rawData.csv";
    $csv->say($fh, ['pa1', 'pa2', 'l1', 'l2', 'skill', 'predict', 'novelty', 'creative', 'complex',
		    'goal2', 'feedback2', 'goal1', 'feedback1', 'chatter', 'waiting',
		    'body', 'control', 'present', 'spont', 'stakes', 'evaluated', 'reward',
		    'injury1', 'injury2', 'recno']);
    my @cc = sort { $#$b <=> $#$a  } $Graph->connected_components();
    my %white;
    $white{$_}=1 for @{ $cc[0] };
    for my $edge (values %EdgeInfo) {
	next if (!$white{$edge->{n1}} or !$white{$edge->{n2}});
	for my $rate (@{ $edge->{rating} }) {
	    $csv->say($fh, [simplifyName($edge->{n1}), simplifyName($edge->{n2}), @$rate]);
	}
    }
}

{
    my $seqno = 0;
    loadZip(shift, ++$seqno) while @ARGV;
}

for my $en (@EndNote) {
    warn "$en\n";
}

for my $k (keys %NodeGroupInfo) {
    my $gi = $NodeGroupInfo{$k};
    next if keys(%$gi) == 1;
    warn $k;  # to decide whether solo or group
}

outputGraph();

outputData();
